/* shutdown-dialog.c generated by valac 0.22.1, the Vala compiler
 * generated from shutdown-dialog.vala, do not modify */

/* -*- Mode: Vala; indent-tabs-mode: nil; tab-width: 4 -*-
 *
 * Copyright (C) 2013 Canonical Ltd
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 3 as
 * published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Authors: Robert Ancell <robert.ancell@canonical.com>
 *          Marco Trevisan <marco.trevisan@canonical.com>
 */

#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <cairo.h>
#include <gdk/gdk.h>
#include <stdlib.h>
#include <string.h>
#include <glib/gi18n-lib.h>
#include <pango/pango.h>
#include <float.h>
#include <math.h>
#include <gio/gio.h>
#include <lightdm.h>
#include "config.h"
#include <atk/atk.h>


#define TYPE_SHUTDOWN_DIALOG_TYPE (shutdown_dialog_type_get_type ())

#define TYPE_SHUTDOWN_DIALOG (shutdown_dialog_get_type ())
#define SHUTDOWN_DIALOG(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_SHUTDOWN_DIALOG, ShutdownDialog))
#define SHUTDOWN_DIALOG_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_SHUTDOWN_DIALOG, ShutdownDialogClass))
#define IS_SHUTDOWN_DIALOG(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_SHUTDOWN_DIALOG))
#define IS_SHUTDOWN_DIALOG_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_SHUTDOWN_DIALOG))
#define SHUTDOWN_DIALOG_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_SHUTDOWN_DIALOG, ShutdownDialogClass))

typedef struct _ShutdownDialog ShutdownDialog;
typedef struct _ShutdownDialogClass ShutdownDialogClass;
typedef struct _ShutdownDialogPrivate ShutdownDialogPrivate;

#define TYPE_MONITOR (monitor_get_type ())
#define MONITOR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_MONITOR, Monitor))
#define MONITOR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_MONITOR, MonitorClass))
#define IS_MONITOR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_MONITOR))
#define IS_MONITOR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_MONITOR))
#define MONITOR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_MONITOR, MonitorClass))

typedef struct _Monitor Monitor;
typedef struct _MonitorClass MonitorClass;

#define TYPE_BACKGROUND (background_get_type ())
#define BACKGROUND(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_BACKGROUND, Background))
#define BACKGROUND_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_BACKGROUND, BackgroundClass))
#define IS_BACKGROUND(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_BACKGROUND))
#define IS_BACKGROUND_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_BACKGROUND))
#define BACKGROUND_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_BACKGROUND, BackgroundClass))

typedef struct _Background Background;
typedef struct _BackgroundClass BackgroundClass;

#define TYPE_DIALOG_BUTTON (dialog_button_get_type ())
#define DIALOG_BUTTON(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_DIALOG_BUTTON, DialogButton))
#define DIALOG_BUTTON_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_DIALOG_BUTTON, DialogButtonClass))
#define IS_DIALOG_BUTTON(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_DIALOG_BUTTON))
#define IS_DIALOG_BUTTON_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_DIALOG_BUTTON))
#define DIALOG_BUTTON_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_DIALOG_BUTTON, DialogButtonClass))

typedef struct _DialogButton DialogButton;
typedef struct _DialogButtonClass DialogButtonClass;

#define TYPE_ANIMATE_TIMER (animate_timer_get_type ())
#define ANIMATE_TIMER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_ANIMATE_TIMER, AnimateTimer))
#define ANIMATE_TIMER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_ANIMATE_TIMER, AnimateTimerClass))
#define IS_ANIMATE_TIMER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_ANIMATE_TIMER))
#define IS_ANIMATE_TIMER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_ANIMATE_TIMER))
#define ANIMATE_TIMER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_ANIMATE_TIMER, AnimateTimerClass))

typedef struct _AnimateTimer AnimateTimer;
typedef struct _AnimateTimerClass AnimateTimerClass;
#define _cairo_surface_destroy0(var) ((var == NULL) ? NULL : (var = (cairo_surface_destroy (var), NULL)))
#define _cairo_pattern_destroy0(var) ((var == NULL) ? NULL : (var = (cairo_pattern_destroy (var), NULL)))
#define _monitor_unref0(var) ((var == NULL) ? NULL : (var = (monitor_unref (var), NULL)))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
typedef struct _Block5Data Block5Data;
#define _g_free0(var) (var = (g_free (var), NULL))
#define __vala_PangoFontDescription_free0(var) ((var == NULL) ? NULL : (var = (_vala_PangoFontDescription_free (var), NULL)))
#define _g_variant_type_free0(var) ((var == NULL) ? NULL : (var = (g_variant_type_free (var), NULL)))
#define _g_variant_unref0(var) ((var == NULL) ? NULL : (var = (g_variant_unref (var), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
typedef struct _Block6Data Block6Data;
typedef struct _MonitorPrivate MonitorPrivate;
#define _cairo_destroy0(var) ((var == NULL) ? NULL : (var = (cairo_destroy (var), NULL)))
typedef struct _DialogButtonPrivate DialogButtonPrivate;

typedef enum  {
	SHUTDOWN_DIALOG_TYPE_LOGOUT,
	SHUTDOWN_DIALOG_TYPE_SHUTDOWN,
	SHUTDOWN_DIALOG_TYPE_RESTART
} ShutdownDialogType;

struct _ShutdownDialog {
	GtkFixed parent_instance;
	ShutdownDialogPrivate * priv;
};

struct _ShutdownDialogClass {
	GtkFixedClass parent_class;
};

struct _ShutdownDialogPrivate {
	cairo_surface_t* bg_surface;
	cairo_surface_t* corner_surface;
	cairo_surface_t* left_surface;
	cairo_surface_t* top_surface;
	cairo_pattern_t* corner_pattern;
	cairo_pattern_t* left_pattern;
	cairo_pattern_t* top_pattern;
	Monitor* monitor;
	Background* background;
	GdkRGBA avg_color;
	GtkBox* vbox;
	DialogButton* close_button;
	GtkBox* button_box;
	GtkEventBox* monitor_events;
	GtkEventBox* vbox_events;
	AnimateTimer* animation;
	gboolean closing;
};

struct _Block5Data {
	int _ref_count_;
	ShutdownDialog * self;
	DialogButton* shutdown_button;
};

typedef gdouble (*AnimateTimerEasingFunc) (gdouble x, void* user_data);
struct _Block6Data {
	int _ref_count_;
	ShutdownDialog * self;
	gfloat start_value;
};

struct _Monitor {
	GTypeInstance parent_instance;
	volatile int ref_count;
	MonitorPrivate * priv;
	gint x;
	gint y;
	gint width;
	gint height;
};

struct _MonitorClass {
	GTypeClass parent_class;
	void (*finalize) (Monitor *self);
};

struct _DialogButton {
	GtkButton parent_instance;
	DialogButtonPrivate * priv;
};

struct _DialogButtonClass {
	GtkButtonClass parent_class;
};

struct _DialogButtonPrivate {
	gchar* inactive_filename;
	gchar* focused_filename;
	gchar* active_filename;
	GtkImage* i;
	GtkLabel* l;
};


static gpointer shutdown_dialog_parent_class = NULL;
static gpointer dialog_button_parent_class = NULL;

GType shutdown_dialog_type_get_type (void) G_GNUC_CONST;
GType shutdown_dialog_get_type (void) G_GNUC_CONST;
gpointer monitor_ref (gpointer instance);
void monitor_unref (gpointer instance);
GParamSpec* param_spec_monitor (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void value_set_monitor (GValue* value, gpointer v_object);
void value_take_monitor (GValue* value, gpointer v_object);
gpointer value_get_monitor (const GValue* value);
GType monitor_get_type (void) G_GNUC_CONST;
GType background_get_type (void) G_GNUC_CONST;
GType dialog_button_get_type (void) G_GNUC_CONST;
GType animate_timer_get_type (void) G_GNUC_CONST;
#define SHUTDOWN_DIALOG_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), TYPE_SHUTDOWN_DIALOG, ShutdownDialogPrivate))
enum  {
	SHUTDOWN_DIALOG_DUMMY_PROPERTY
};
#define SHUTDOWN_DIALOG_BORDER_SIZE 30
#define SHUTDOWN_DIALOG_BORDER_INTERNAL_SIZE 10
#define SHUTDOWN_DIALOG_BORDER_EXTERNAL_SIZE (SHUTDOWN_DIALOG_BORDER_SIZE - SHUTDOWN_DIALOG_BORDER_INTERNAL_SIZE)
#define SHUTDOWN_DIALOG_CLOSE_OFFSET 3
#define SHUTDOWN_DIALOG_BUTTON_TEXT_SPACE 9
#define SHUTDOWN_DIALOG_BLUR_RADIUS 8
ShutdownDialog* shutdown_dialog_new (ShutdownDialogType type, Background* bg);
ShutdownDialog* shutdown_dialog_construct (GType object_type, ShutdownDialogType type, Background* bg);
static Block5Data* block5_data_ref (Block5Data* _data5_);
static void block5_data_unref (void * _userdata_);
static void shutdown_dialog_rebuild_background (ShutdownDialog* self);
static void _shutdown_dialog_rebuild_background_g_object_notify (GObject* _sender, GParamSpec* pspec, gpointer self);
static void shutdown_dialog_update_background_color (ShutdownDialog* self);
static void _shutdown_dialog_update_background_color_g_object_notify (GObject* _sender, GParamSpec* pspec, gpointer self);
static gboolean __lambda15_ (ShutdownDialog* self);
void shutdown_dialog_close (ShutdownDialog* self);
static gboolean ___lambda15__gtk_widget_button_press_event (GtkWidget* _sender, GdkEventButton* event, gpointer self);
static gboolean __lambda18_ (ShutdownDialog* self);
static gboolean ___lambda18__gtk_widget_button_press_event (GtkWidget* _sender, GdkEventButton* event, gpointer self);
static void _vala_PangoFontDescription_free (PangoFontDescription* self);
static DialogButton* shutdown_dialog_add_button (ShutdownDialog* self, const gchar* text, const gchar* inactive_filename, const gchar* active_filename);
static void ____lambda19_ (ShutdownDialog* self);
static void _____lambda19__gtk_button_clicked (GtkButton* _sender, gpointer self);
static void ____lambda20_ (ShutdownDialog* self);
static void _____lambda20__gtk_button_clicked (GtkButton* _sender, gpointer self);
static void __lambda21_ (ShutdownDialog* self);
static void ___lambda21__gtk_button_clicked (GtkButton* _sender, gpointer self);
static void __lambda22_ (ShutdownDialog* self);
static void ___lambda22__gtk_button_clicked (GtkButton* _sender, gpointer self);
static void ___lambda23_ (Block5Data* _data5_);
static void ____lambda23__gtk_widget_show (GtkWidget* _sender, gpointer self);
DialogButton* dialog_button_new (const gchar* inactive_filename, const gchar* focused_filename, const gchar* active_filename, GtkLabel* label);
DialogButton* dialog_button_construct (GType object_type, const gchar* inactive_filename, const gchar* focused_filename, const gchar* active_filename, GtkLabel* label);
static void __lambda24_ (ShutdownDialog* self);
static void ___lambda24__gtk_button_clicked (GtkButton* _sender, gpointer self);
static gdouble __lambda25_ (ShutdownDialog* self, gdouble x);
static gdouble ___lambda25__animate_timer_easing_func (gdouble x, gpointer self);
#define ANIMATE_TIMER_INSTANT 150
AnimateTimer* animate_timer_new (AnimateTimerEasingFunc func, void* func_target, gint speed);
AnimateTimer* animate_timer_construct (GType object_type, AnimateTimerEasingFunc func, void* func_target, gint speed);
static void __lambda26_ (ShutdownDialog* self);
static void ___lambda26__animate_timer_animate (AnimateTimer* _sender, gdouble progress, gpointer self);
static void __lambda27_ (ShutdownDialog* self);
void animate_timer_reset (AnimateTimer* self, gint temp_speed);
static void ___lambda27__gtk_widget_show (GtkWidget* _sender, gpointer self);
gboolean shutdown_dialog_isNumber (ShutdownDialog* self, gdouble d);
static Block6Data* block6_data_ref (Block6Data* _data6_);
static void block6_data_unref (void * _userdata_);
static gdouble __lambda16_ (Block6Data* _data6_, gdouble x);
static gdouble ___lambda16__animate_timer_easing_func (gdouble x, gpointer self);
static void __lambda17_ (ShutdownDialog* self, gdouble p);
void animate_timer_stop (AnimateTimer* self);
static void ___lambda17__animate_timer_animate (AnimateTimer* _sender, gdouble progress, gpointer self);
void background_get_average_color (Background* self, GdkRGBA* result);
void shutdown_dialog_set_active_monitor (ShutdownDialog* self, Monitor* m);
gboolean monitor_equals (Monitor* self, Monitor* other);
void shutdown_dialog_focus_next (ShutdownDialog* self);
void shutdown_dialog_focus_prev (ShutdownDialog* self);
void shutdown_dialog_cancel (ShutdownDialog* self);
static void shutdown_dialog_real_size_allocate (GtkWidget* base, GtkAllocation* allocation);
static gboolean shutdown_dialog_real_draw (GtkWidget* base, cairo_t* c);
gboolean animate_timer_get_is_running (AnimateTimer* self);
void cairo_utils_exponential_blur_surface (cairo_surface_t* surface, gint radius);
void cairo_utils_rounded_rectangle (cairo_t* c, gdouble x, gdouble y, gdouble width, gdouble height, gdouble radius);
gdouble animate_timer_get_progress (AnimateTimer* self);
static void shutdown_dialog_finalize (GObject* obj);
#define DIALOG_BUTTON_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), TYPE_DIALOG_BUTTON, DialogButtonPrivate))
enum  {
	DIALOG_BUTTON_DUMMY_PROPERTY
};
void unity_greeter_add_style_class (GtkWidget* widget);
static gboolean dialog_button_real_enter_notify_event (GtkWidget* base, GdkEventCrossing* event);
static gboolean dialog_button_real_leave_notify_event (GtkWidget* base, GdkEventCrossing* event);
static gboolean dialog_button_real_draw (GtkWidget* base, cairo_t* c);
static void dialog_button_real_state_flags_changed (GtkWidget* base, GtkStateFlags previous_state);
static void dialog_button_finalize (GObject* obj);


GType shutdown_dialog_type_get_type (void) {
	static volatile gsize shutdown_dialog_type_type_id__volatile = 0;
	if (g_once_init_enter (&shutdown_dialog_type_type_id__volatile)) {
		static const GEnumValue values[] = {{SHUTDOWN_DIALOG_TYPE_LOGOUT, "SHUTDOWN_DIALOG_TYPE_LOGOUT", "logout"}, {SHUTDOWN_DIALOG_TYPE_SHUTDOWN, "SHUTDOWN_DIALOG_TYPE_SHUTDOWN", "shutdown"}, {SHUTDOWN_DIALOG_TYPE_RESTART, "SHUTDOWN_DIALOG_TYPE_RESTART", "restart"}, {0, NULL, NULL}};
		GType shutdown_dialog_type_type_id;
		shutdown_dialog_type_type_id = g_enum_register_static ("ShutdownDialogType", values);
		g_once_init_leave (&shutdown_dialog_type_type_id__volatile, shutdown_dialog_type_type_id);
	}
	return shutdown_dialog_type_type_id__volatile;
}


static Block5Data* block5_data_ref (Block5Data* _data5_) {
	g_atomic_int_inc (&_data5_->_ref_count_);
	return _data5_;
}


static void block5_data_unref (void * _userdata_) {
	Block5Data* _data5_;
	_data5_ = (Block5Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data5_->_ref_count_)) {
		ShutdownDialog * self;
		self = _data5_->self;
		_g_object_unref0 (_data5_->shutdown_button);
		_g_object_unref0 (self);
		g_slice_free (Block5Data, _data5_);
	}
}


static void _shutdown_dialog_rebuild_background_g_object_notify (GObject* _sender, GParamSpec* pspec, gpointer self) {
	shutdown_dialog_rebuild_background (self);
}


static void _shutdown_dialog_update_background_color_g_object_notify (GObject* _sender, GParamSpec* pspec, gpointer self) {
	shutdown_dialog_update_background_color (self);
}


static gboolean __lambda15_ (ShutdownDialog* self) {
	gboolean result = FALSE;
	shutdown_dialog_close (self);
	g_debug ("shutdown-dialog.vala:75: ~~~~~~~~~close shutdown dialog on click~~~~~~" \
"~~~~");
	result = TRUE;
	return result;
}


static gboolean ___lambda15__gtk_widget_button_press_event (GtkWidget* _sender, GdkEventButton* event, gpointer self) {
	gboolean result;
	result = __lambda15_ (self);
	return result;
}


static gboolean __lambda18_ (ShutdownDialog* self) {
	gboolean result = FALSE;
	result = TRUE;
	return result;
}


static gboolean ___lambda18__gtk_widget_button_press_event (GtkWidget* _sender, GdkEventButton* event, gpointer self) {
	gboolean result;
	result = __lambda18_ (self);
	return result;
}


static void _vala_PangoFontDescription_free (PangoFontDescription* self) {
	g_boxed_free (pango_font_description_get_type (), self);
}


static void ____lambda19_ (ShutdownDialog* self) {
	GError * _inner_error_ = NULL;
	{
		lightdm_suspend (&_inner_error_);
		if (_inner_error_ != NULL) {
			goto __catch22_g_error;
		}
		shutdown_dialog_close (self);
	}
	goto __finally22;
	__catch22_g_error:
	{
		GError* e = NULL;
		GError* _tmp0_ = NULL;
		const gchar* _tmp1_ = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp0_ = e;
		_tmp1_ = _tmp0_->message;
		g_warning ("shutdown-dialog.vala:166: Failed to suspend: %s", _tmp1_);
		_g_error_free0 (e);
	}
	__finally22:
	if (_inner_error_ != NULL) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return;
	}
}


static void _____lambda19__gtk_button_clicked (GtkButton* _sender, gpointer self) {
	____lambda19_ (self);
}


static void ____lambda20_ (ShutdownDialog* self) {
	GError * _inner_error_ = NULL;
	{
		lightdm_hibernate (&_inner_error_);
		if (_inner_error_ != NULL) {
			goto __catch23_g_error;
		}
		shutdown_dialog_close (self);
	}
	goto __finally23;
	__catch23_g_error:
	{
		GError* e = NULL;
		GError* _tmp0_ = NULL;
		const gchar* _tmp1_ = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp0_ = e;
		_tmp1_ = _tmp0_->message;
		g_warning ("shutdown-dialog.vala:183: Failed to hibernate: %s", _tmp1_);
		_g_error_free0 (e);
	}
	__finally23:
	if (_inner_error_ != NULL) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return;
	}
}


static void _____lambda20__gtk_button_clicked (GtkButton* _sender, gpointer self) {
	____lambda20_ (self);
}


static void __lambda21_ (ShutdownDialog* self) {
	GError * _inner_error_ = NULL;
	{
		lightdm_restart (&_inner_error_);
		if (_inner_error_ != NULL) {
			goto __catch24_g_error;
		}
		shutdown_dialog_close (self);
	}
	goto __finally24;
	__catch24_g_error:
	{
		GError* e = NULL;
		GError* _tmp0_ = NULL;
		const gchar* _tmp1_ = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp0_ = e;
		_tmp1_ = _tmp0_->message;
		g_warning ("shutdown-dialog.vala:206: Failed to restart: %s", _tmp1_);
		_g_error_free0 (e);
	}
	__finally24:
	if (_inner_error_ != NULL) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return;
	}
}


static void ___lambda21__gtk_button_clicked (GtkButton* _sender, gpointer self) {
	__lambda21_ (self);
}


static void __lambda22_ (ShutdownDialog* self) {
	GError * _inner_error_ = NULL;
	{
		lightdm_shutdown (&_inner_error_);
		if (_inner_error_ != NULL) {
			goto __catch25_g_error;
		}
		shutdown_dialog_close (self);
	}
	goto __finally25;
	__catch25_g_error:
	{
		GError* e = NULL;
		GError* _tmp0_ = NULL;
		const gchar* _tmp1_ = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp0_ = e;
		_tmp1_ = _tmp0_->message;
		g_warning ("shutdown-dialog.vala:227: Failed to shutdown: %s", _tmp1_);
		_g_error_free0 (e);
	}
	__finally25:
	if (_inner_error_ != NULL) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return;
	}
}


static void ___lambda22__gtk_button_clicked (GtkButton* _sender, gpointer self) {
	__lambda22_ (self);
}


static void ___lambda23_ (Block5Data* _data5_) {
	ShutdownDialog * self;
	DialogButton* _tmp0_ = NULL;
	self = _data5_->self;
	_tmp0_ = _data5_->shutdown_button;
	gtk_widget_grab_focus ((GtkWidget*) _tmp0_);
}


static void ____lambda23__gtk_widget_show (GtkWidget* _sender, gpointer self) {
	___lambda23_ (self);
}


static void __lambda24_ (ShutdownDialog* self) {
	shutdown_dialog_close (self);
}


static void ___lambda24__gtk_button_clicked (GtkButton* _sender, gpointer self) {
	__lambda24_ (self);
}


static gdouble __lambda25_ (ShutdownDialog* self, gdouble x) {
	gdouble result = 0.0;
	gdouble _tmp0_ = 0.0;
	_tmp0_ = x;
	result = _tmp0_;
	return result;
}


static gdouble ___lambda25__animate_timer_easing_func (gdouble x, gpointer self) {
	gdouble result;
	result = __lambda25_ (self, x);
	return result;
}


static void __lambda26_ (ShutdownDialog* self) {
	gtk_widget_queue_draw ((GtkWidget*) self);
}


static void ___lambda26__animate_timer_animate (AnimateTimer* _sender, gdouble progress, gpointer self) {
	__lambda26_ (self);
}


static void __lambda27_ (ShutdownDialog* self) {
	AnimateTimer* _tmp0_ = NULL;
	_tmp0_ = self->priv->animation;
	animate_timer_reset (_tmp0_, -1);
}


static void ___lambda27__gtk_widget_show (GtkWidget* _sender, gpointer self) {
	__lambda27_ (self);
}


ShutdownDialog* shutdown_dialog_construct (GType object_type, ShutdownDialogType type, Background* bg) {
	ShutdownDialog * self = NULL;
	Block5Data* _data5_;
	Background* _tmp0_ = NULL;
	Background* _tmp1_ = NULL;
	Background* _tmp2_ = NULL;
	GtkEventBox* _tmp3_ = NULL;
	GtkEventBox* _tmp4_ = NULL;
	GtkEventBox* _tmp5_ = NULL;
	GtkEventBox* _tmp6_ = NULL;
	GtkEventBox* _tmp7_ = NULL;
	GdkEventMask _tmp8_ = 0;
	GdkEventMask _tmp9_ = 0;
	GtkEventBox* _tmp10_ = NULL;
	GtkEventBox* _tmp11_ = NULL;
	GtkBox* _tmp12_ = NULL;
	GtkBox* _tmp13_ = NULL;
	GtkBox* _tmp14_ = NULL;
	GtkBox* _tmp15_ = NULL;
	GtkBox* _tmp16_ = NULL;
	gint _tmp17_ = 0;
	gint _tmp18_ = 0;
	GtkBox* _tmp19_ = NULL;
	GtkBox* _tmp20_ = NULL;
	gint _tmp21_ = 0;
	gint _tmp22_ = 0;
	GtkBox* _tmp23_ = NULL;
	GtkBox* _tmp24_ = NULL;
	gint _tmp25_ = 0;
	gint _tmp26_ = 0;
	GtkBox* _tmp27_ = NULL;
	GtkBox* _tmp28_ = NULL;
	gint _tmp29_ = 0;
	gint _tmp30_ = 0;
	GtkEventBox* _tmp31_ = NULL;
	GtkEventBox* _tmp32_ = NULL;
	GtkEventBox* _tmp33_ = NULL;
	GtkEventBox* _tmp34_ = NULL;
	GtkEventBox* _tmp35_ = NULL;
	GdkEventMask _tmp36_ = 0;
	GdkEventMask _tmp37_ = 0;
	GtkEventBox* _tmp38_ = NULL;
	GtkEventBox* _tmp39_ = NULL;
	GtkBox* _tmp40_ = NULL;
	GtkEventBox* _tmp41_ = NULL;
	GtkEventBox* _tmp42_ = NULL;
	gchar* text = NULL;
	ShutdownDialogType _tmp43_ = 0;
	gboolean have_open_sessions = FALSE;
	gboolean _tmp72_ = FALSE;
	GtkLabel* label = NULL;
	const gchar* _tmp76_ = NULL;
	GtkLabel* _tmp77_ = NULL;
	GtkLabel* _tmp78_ = NULL;
	GtkLabel* _tmp79_ = NULL;
	PangoFontDescription* _tmp80_ = NULL;
	PangoFontDescription* _tmp81_ = NULL;
	GtkLabel* _tmp82_ = NULL;
	GdkRGBA _tmp83_ = {0};
	GtkLabel* _tmp84_ = NULL;
	GtkLabel* _tmp85_ = NULL;
	GtkBox* _tmp86_ = NULL;
	GtkLabel* _tmp87_ = NULL;
	GtkBox* _tmp88_ = NULL;
	GtkBox* _tmp89_ = NULL;
	GtkBox* _tmp90_ = NULL;
	GtkBox* _tmp91_ = NULL;
	ShutdownDialogType _tmp92_ = 0;
	gboolean _tmp111_ = FALSE;
	DialogButton* restart_button = NULL;
	const gchar* _tmp112_ = NULL;
	gchar* _tmp113_ = NULL;
	gchar* _tmp114_ = NULL;
	gchar* _tmp115_ = NULL;
	gchar* _tmp116_ = NULL;
	DialogButton* _tmp117_ = NULL;
	DialogButton* _tmp118_ = NULL;
	DialogButton* _tmp119_ = NULL;
	gboolean _tmp120_ = FALSE;
	const gchar* _tmp121_ = NULL;
	gchar* _tmp122_ = NULL;
	gchar* _tmp123_ = NULL;
	gchar* _tmp124_ = NULL;
	gchar* _tmp125_ = NULL;
	DialogButton* _tmp126_ = NULL;
	DialogButton* _tmp127_ = NULL;
	DialogButton* _tmp128_ = NULL;
	ShutdownDialogType _tmp129_ = 0;
	gchar* _tmp130_ = NULL;
	gchar* _tmp131_ = NULL;
	gchar* _tmp132_ = NULL;
	gchar* _tmp133_ = NULL;
	gchar* _tmp134_ = NULL;
	gchar* _tmp135_ = NULL;
	DialogButton* _tmp136_ = NULL;
	DialogButton* _tmp137_ = NULL;
	DialogButton* _tmp138_ = NULL;
	DialogButton* _tmp139_ = NULL;
	DialogButton* _tmp140_ = NULL;
	AnimateTimer* _tmp141_ = NULL;
	AnimateTimer* _tmp142_ = NULL;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (bg != NULL, NULL);
	_data5_ = g_slice_new0 (Block5Data);
	_data5_->_ref_count_ = 1;
	self = (ShutdownDialog*) g_object_new (object_type, NULL);
	_data5_->self = g_object_ref (self);
	_tmp0_ = bg;
	self->priv->background = _tmp0_;
	_tmp1_ = self->priv->background;
	g_signal_connect_object ((GObject*) _tmp1_, "notify::alpha", (GCallback) _shutdown_dialog_rebuild_background_g_object_notify, self, 0);
	_tmp2_ = self->priv->background;
	g_signal_connect_object ((GObject*) _tmp2_, "notify::average-color", (GCallback) _shutdown_dialog_update_background_color_g_object_notify, self, 0);
	shutdown_dialog_update_background_color (self);
	_tmp3_ = (GtkEventBox*) gtk_event_box_new ();
	g_object_ref_sink (_tmp3_);
	_g_object_unref0 (self->priv->monitor_events);
	self->priv->monitor_events = _tmp3_;
	_tmp4_ = self->priv->monitor_events;
	gtk_widget_set_visible ((GtkWidget*) _tmp4_, TRUE);
	_tmp5_ = self->priv->monitor_events;
	gtk_event_box_set_visible_window (_tmp5_, FALSE);
	_tmp6_ = self->priv->monitor_events;
	_tmp7_ = self->priv->monitor_events;
	_tmp8_ = gtk_widget_get_events ((GtkWidget*) _tmp7_);
	_tmp9_ = _tmp8_;
	gtk_widget_set_events ((GtkWidget*) _tmp7_, _tmp9_ | GDK_BUTTON_PRESS_MASK);
	_tmp10_ = self->priv->monitor_events;
	g_signal_connect_object ((GtkWidget*) _tmp10_, "button-press-event", (GCallback) ___lambda15__gtk_widget_button_press_event, self, 0);
	_tmp11_ = self->priv->monitor_events;
	gtk_container_add ((GtkContainer*) self, (GtkWidget*) _tmp11_);
	_tmp12_ = (GtkBox*) gtk_box_new (GTK_ORIENTATION_VERTICAL, 10);
	g_object_ref_sink (_tmp12_);
	_g_object_unref0 (self->priv->vbox);
	self->priv->vbox = _tmp12_;
	_tmp13_ = self->priv->vbox;
	gtk_widget_set_visible ((GtkWidget*) _tmp13_, TRUE);
	_tmp14_ = self->priv->vbox;
	g_object_set ((GtkWidget*) _tmp14_, "margin", SHUTDOWN_DIALOG_BORDER_INTERNAL_SIZE, NULL);
	_tmp15_ = self->priv->vbox;
	_tmp16_ = self->priv->vbox;
	_tmp17_ = gtk_widget_get_margin_top ((GtkWidget*) _tmp16_);
	_tmp18_ = _tmp17_;
	gtk_widget_set_margin_top ((GtkWidget*) _tmp16_, _tmp18_ + 9);
	_tmp19_ = self->priv->vbox;
	_tmp20_ = self->priv->vbox;
	_tmp21_ = gtk_widget_get_margin_left ((GtkWidget*) _tmp20_);
	_tmp22_ = _tmp21_;
	gtk_widget_set_margin_left ((GtkWidget*) _tmp20_, _tmp22_ + 20);
	_tmp23_ = self->priv->vbox;
	_tmp24_ = self->priv->vbox;
	_tmp25_ = gtk_widget_get_margin_right ((GtkWidget*) _tmp24_);
	_tmp26_ = _tmp25_;
	gtk_widget_set_margin_right ((GtkWidget*) _tmp24_, _tmp26_ + 20);
	_tmp27_ = self->priv->vbox;
	_tmp28_ = self->priv->vbox;
	_tmp29_ = gtk_widget_get_margin_bottom ((GtkWidget*) _tmp28_);
	_tmp30_ = _tmp29_;
	gtk_widget_set_margin_bottom ((GtkWidget*) _tmp28_, _tmp30_ + 2);
	_tmp31_ = (GtkEventBox*) gtk_event_box_new ();
	g_object_ref_sink (_tmp31_);
	_g_object_unref0 (self->priv->vbox_events);
	self->priv->vbox_events = _tmp31_;
	_tmp32_ = self->priv->vbox_events;
	gtk_widget_set_visible ((GtkWidget*) _tmp32_, TRUE);
	_tmp33_ = self->priv->vbox_events;
	gtk_event_box_set_visible_window (_tmp33_, FALSE);
	_tmp34_ = self->priv->vbox_events;
	_tmp35_ = self->priv->vbox_events;
	_tmp36_ = gtk_widget_get_events ((GtkWidget*) _tmp35_);
	_tmp37_ = _tmp36_;
	gtk_widget_set_events ((GtkWidget*) _tmp35_, _tmp37_ | GDK_BUTTON_PRESS_MASK);
	_tmp38_ = self->priv->vbox_events;
	g_signal_connect_object ((GtkWidget*) _tmp38_, "button-press-event", (GCallback) ___lambda18__gtk_widget_button_press_event, self, 0);
	_tmp39_ = self->priv->vbox_events;
	_tmp40_ = self->priv->vbox;
	gtk_container_add ((GtkContainer*) _tmp39_, (GtkWidget*) _tmp40_);
	_tmp41_ = self->priv->monitor_events;
	_tmp42_ = self->priv->vbox_events;
	gtk_container_add ((GtkContainer*) _tmp41_, (GtkWidget*) _tmp42_);
	_tmp43_ = type;
	if (_tmp43_ == SHUTDOWN_DIALOG_TYPE_SHUTDOWN) {
		const gchar* _tmp44_ = NULL;
		gchar* _tmp45_ = NULL;
		_tmp44_ = _ ("Goodbye. Would you like to…");
		_tmp45_ = g_strdup (_tmp44_);
		_g_free0 (text);
		text = _tmp45_;
	} else {
		GtkLabel* title_label = NULL;
		const gchar* _tmp46_ = NULL;
		GtkLabel* _tmp47_ = NULL;
		GtkLabel* _tmp48_ = NULL;
		GtkLabel* _tmp49_ = NULL;
		PangoFontDescription* _tmp50_ = NULL;
		PangoFontDescription* _tmp51_ = NULL;
		GtkLabel* _tmp52_ = NULL;
		GdkRGBA _tmp53_ = {0};
		GtkLabel* _tmp54_ = NULL;
		GtkBox* _tmp55_ = NULL;
		GtkLabel* _tmp56_ = NULL;
		const gchar* _tmp57_ = NULL;
		gchar* _tmp58_ = NULL;
		_tmp46_ = _ ("Shut Down");
		_tmp47_ = (GtkLabel*) gtk_label_new (_tmp46_);
		g_object_ref_sink (_tmp47_);
		title_label = _tmp47_;
		_tmp48_ = title_label;
		gtk_widget_set_visible ((GtkWidget*) _tmp48_, TRUE);
		_tmp49_ = title_label;
		_tmp50_ = pango_font_description_from_string ("Ubuntu Light 15");
		_tmp51_ = _tmp50_;
		gtk_widget_override_font ((GtkWidget*) _tmp49_, _tmp51_);
		__vala_PangoFontDescription_free0 (_tmp51_);
		_tmp52_ = title_label;
		_tmp53_.red = (gdouble) 1.0f;
		_tmp53_.green = (gdouble) 1.0f;
		_tmp53_.blue = (gdouble) 1.0f;
		_tmp53_.alpha = (gdouble) 1.0f;
		gtk_widget_override_color ((GtkWidget*) _tmp52_, GTK_STATE_FLAG_NORMAL, &_tmp53_);
		_tmp54_ = title_label;
		gtk_misc_set_alignment ((GtkMisc*) _tmp54_, 0.0f, 0.5f);
		_tmp55_ = self->priv->vbox;
		_tmp56_ = title_label;
		gtk_box_pack_start (_tmp55_, (GtkWidget*) _tmp56_, FALSE, FALSE, (guint) 0);
		_tmp57_ = _ ("Are you sure you want to shut down the computer?");
		_tmp58_ = g_strdup (_tmp57_);
		_g_free0 (text);
		text = _tmp58_;
		_g_object_unref0 (title_label);
	}
	have_open_sessions = FALSE;
	{
		GDBusConnection* b = NULL;
		GDBusConnection* _tmp59_ = NULL;
		GVariant* _result_ = NULL;
		GDBusConnection* _tmp60_ = NULL;
		GVariant* _tmp61_ = NULL;
		GVariant* _tmp62_ = NULL;
		GVariantType* _tmp63_ = NULL;
		GVariantType* _tmp64_ = NULL;
		GVariant* _tmp65_ = NULL;
		GVariant* _tmp66_ = NULL;
		GVariant* value = NULL;
		GVariant* _tmp67_ = NULL;
		GVariant* _tmp68_ = NULL;
		gsize _tmp69_ = 0UL;
		_tmp59_ = g_bus_get_sync (G_BUS_TYPE_SYSTEM, NULL, &_inner_error_);
		b = _tmp59_;
		if (_inner_error_ != NULL) {
			goto __catch21_g_error;
		}
		_tmp60_ = b;
		_tmp61_ = g_variant_new ("(ss)", "org.freedesktop.DisplayManager", "Sessions", NULL);
		g_variant_ref_sink (_tmp61_);
		_tmp62_ = _tmp61_;
		_tmp63_ = g_variant_type_new ("(v)");
		_tmp64_ = _tmp63_;
		_tmp65_ = g_dbus_connection_call_sync (_tmp60_, "org.freedesktop.DisplayManager", "/org/freedesktop/DisplayManager", "org.freedesktop.DBus.Properties", "Get", _tmp62_, _tmp64_, G_DBUS_CALL_FLAGS_NONE, -1, NULL, &_inner_error_);
		_tmp66_ = _tmp65_;
		_g_variant_type_free0 (_tmp64_);
		_g_variant_unref0 (_tmp62_);
		_result_ = _tmp66_;
		if (_inner_error_ != NULL) {
			_g_object_unref0 (b);
			goto __catch21_g_error;
		}
		_tmp67_ = _result_;
		g_variant_get (_tmp67_, "(v)", &value, NULL);
		_tmp68_ = value;
		_tmp69_ = g_variant_n_children (_tmp68_);
		have_open_sessions = _tmp69_ > ((gsize) 0);
		_g_variant_unref0 (value);
		_g_variant_unref0 (_result_);
		_g_object_unref0 (b);
	}
	goto __finally21;
	__catch21_g_error:
	{
		GError* e = NULL;
		GError* _tmp70_ = NULL;
		const gchar* _tmp71_ = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp70_ = e;
		_tmp71_ = _tmp70_->message;
		g_warning ("shutdown-dialog.vala:135: Failed to check sessions from logind: %s", _tmp71_);
		_g_error_free0 (e);
	}
	__finally21:
	if (_inner_error_ != NULL) {
		_g_free0 (text);
		block5_data_unref (_data5_);
		_data5_ = NULL;
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
	_tmp72_ = have_open_sessions;
	if (_tmp72_) {
		const gchar* _tmp73_ = NULL;
		const gchar* _tmp74_ = NULL;
		gchar* _tmp75_ = NULL;
		_tmp73_ = _ ("Other users are currently logged in to this computer, shutting down no" \
"w will also close these other sessions.");
		_tmp74_ = text;
		_tmp75_ = g_strdup_printf ("%s\n\n%s", _tmp73_, _tmp74_);
		_g_free0 (text);
		text = _tmp75_;
	}
	_tmp76_ = text;
	_tmp77_ = (GtkLabel*) gtk_label_new (_tmp76_);
	g_object_ref_sink (_tmp77_);
	label = _tmp77_;
	_tmp78_ = label;
	gtk_label_set_line_wrap (_tmp78_, TRUE);
	_tmp79_ = label;
	_tmp80_ = pango_font_description_from_string ("Ubuntu Light 12");
	_tmp81_ = _tmp80_;
	gtk_widget_override_font ((GtkWidget*) _tmp79_, _tmp81_);
	__vala_PangoFontDescription_free0 (_tmp81_);
	_tmp82_ = label;
	_tmp83_.red = (gdouble) 1.0f;
	_tmp83_.green = (gdouble) 1.0f;
	_tmp83_.blue = (gdouble) 1.0f;
	_tmp83_.alpha = (gdouble) 1.0f;
	gtk_widget_override_color ((GtkWidget*) _tmp82_, GTK_STATE_FLAG_NORMAL, &_tmp83_);
	_tmp84_ = label;
	gtk_misc_set_alignment ((GtkMisc*) _tmp84_, 0.0f, 0.5f);
	_tmp85_ = label;
	gtk_widget_set_visible ((GtkWidget*) _tmp85_, TRUE);
	_tmp86_ = self->priv->vbox;
	_tmp87_ = label;
	gtk_box_pack_start (_tmp86_, (GtkWidget*) _tmp87_, FALSE, FALSE, (guint) 0);
	_tmp88_ = (GtkBox*) gtk_box_new (GTK_ORIENTATION_HORIZONTAL, 20);
	g_object_ref_sink (_tmp88_);
	_g_object_unref0 (self->priv->button_box);
	self->priv->button_box = _tmp88_;
	_tmp89_ = self->priv->button_box;
	gtk_widget_set_visible ((GtkWidget*) _tmp89_, TRUE);
	_tmp90_ = self->priv->vbox;
	_tmp91_ = self->priv->button_box;
	gtk_box_pack_start (_tmp90_, (GtkWidget*) _tmp91_, FALSE, FALSE, (guint) 0);
	_tmp92_ = type;
	if (_tmp92_ == SHUTDOWN_DIALOG_TYPE_SHUTDOWN) {
		gboolean _tmp93_ = FALSE;
		gboolean _tmp102_ = FALSE;
		g_debug ("shutdown-dialog.vala:153: ~~~~~~~~~LightDM.get_can_suspend~~~~~~~~~~");
		_tmp93_ = lightdm_get_can_suspend ();
		if (_tmp93_) {
			DialogButton* button = NULL;
			const gchar* _tmp94_ = NULL;
			gchar* _tmp95_ = NULL;
			gchar* _tmp96_ = NULL;
			gchar* _tmp97_ = NULL;
			gchar* _tmp98_ = NULL;
			DialogButton* _tmp99_ = NULL;
			DialogButton* _tmp100_ = NULL;
			DialogButton* _tmp101_ = NULL;
			g_debug ("shutdown-dialog.vala:155: ~~~~~~~~~LightDM.get_can_suspend:YES!~~~~~~~" \
"~~~");
			_tmp94_ = _ ("Suspend");
			_tmp95_ = g_build_filename (PKGDATADIR, "suspend.png", NULL);
			_tmp96_ = _tmp95_;
			_tmp97_ = g_build_filename (PKGDATADIR, "suspend_highlight.png", NULL);
			_tmp98_ = _tmp97_;
			_tmp99_ = shutdown_dialog_add_button (self, _tmp94_, _tmp96_, _tmp98_);
			_tmp100_ = _tmp99_;
			_g_free0 (_tmp98_);
			_g_free0 (_tmp96_);
			button = _tmp100_;
			_tmp101_ = button;
			g_signal_connect_object ((GtkButton*) _tmp101_, "clicked", (GCallback) _____lambda19__gtk_button_clicked, self, 0);
			_g_object_unref0 (button);
		}
		g_debug ("shutdown-dialog.vala:170: ~~~~~~~~~LightDM.LightDM.get_can_hibernate~~" \
"~~~~~~~~");
		_tmp102_ = lightdm_get_can_hibernate ();
		if (_tmp102_) {
			DialogButton* button = NULL;
			const gchar* _tmp103_ = NULL;
			gchar* _tmp104_ = NULL;
			gchar* _tmp105_ = NULL;
			gchar* _tmp106_ = NULL;
			gchar* _tmp107_ = NULL;
			DialogButton* _tmp108_ = NULL;
			DialogButton* _tmp109_ = NULL;
			DialogButton* _tmp110_ = NULL;
			g_debug ("shutdown-dialog.vala:172: ~~~~~~~~~LightDM.LightDM.get_can_hibernate:Y" \
"ES!~~~~~~~~~~");
			_tmp103_ = _ ("Hibernate");
			_tmp104_ = g_build_filename (PKGDATADIR, "hibernate.png", NULL);
			_tmp105_ = _tmp104_;
			_tmp106_ = g_build_filename (PKGDATADIR, "hibernate_highlight.png", NULL);
			_tmp107_ = _tmp106_;
			_tmp108_ = shutdown_dialog_add_button (self, _tmp103_, _tmp105_, _tmp107_);
			_tmp109_ = _tmp108_;
			_g_free0 (_tmp107_);
			_g_free0 (_tmp105_);
			button = _tmp109_;
			_tmp110_ = button;
			g_signal_connect_object ((GtkButton*) _tmp110_, "clicked", (GCallback) _____lambda20__gtk_button_clicked, self, 0);
			_g_object_unref0 (button);
		}
	}
	g_debug ("shutdown-dialog.vala:189: ~~~~~~~~~LightDM.LightDM.get_can_restart~~~~" \
"~~~~~~");
	_tmp111_ = lightdm_get_can_restart ();
	if (_tmp111_) {
		g_debug ("shutdown-dialog.vala:192: ~~~~~~~~~LightDM.LightDM.get_can_restart:YES" \
"~~~~~~~~~~");
	} else {
		g_debug ("shutdown-dialog.vala:194: ~~~~~~~~~LightDM.LightDM.get_can_restart:NO," \
" maybe can not restart ~~~~~~~~~~");
	}
	_tmp112_ = _ ("Restart");
	_tmp113_ = g_build_filename (PKGDATADIR, "restart.png", NULL);
	_tmp114_ = _tmp113_;
	_tmp115_ = g_build_filename (PKGDATADIR, "restart_highlight.png", NULL);
	_tmp116_ = _tmp115_;
	_tmp117_ = shutdown_dialog_add_button (self, _tmp112_, _tmp114_, _tmp116_);
	_tmp118_ = _tmp117_;
	_g_free0 (_tmp116_);
	_g_free0 (_tmp114_);
	restart_button = _tmp118_;
	_tmp119_ = restart_button;
	g_signal_connect_object ((GtkButton*) _tmp119_, "clicked", (GCallback) ___lambda21__gtk_button_clicked, self, 0);
	g_debug ("shutdown-dialog.vala:210: ~~~~~~~~~LightDM.LightDM.get_can_shutdown~~~" \
"~~~~~~~");
	_tmp120_ = lightdm_get_can_shutdown ();
	if (_tmp120_) {
		g_debug ("shutdown-dialog.vala:213: ~~~~~~~~~LightDM.LightDM.get_can_shutdown:YE" \
"S!~~~~~~~~~~");
	} else {
		g_debug ("shutdown-dialog.vala:215: ~~~~~~~~~LightDM.LightDM.get_can_shutdown:NO" \
"! maybe can not shutdown~~~~~~~~~~");
	}
	_tmp121_ = _ ("Shut Down");
	_tmp122_ = g_build_filename (PKGDATADIR, "shutdown.png", NULL);
	_tmp123_ = _tmp122_;
	_tmp124_ = g_build_filename (PKGDATADIR, "shutdown_highlight.png", NULL);
	_tmp125_ = _tmp124_;
	_tmp126_ = shutdown_dialog_add_button (self, _tmp121_, _tmp123_, _tmp125_);
	_tmp127_ = _tmp126_;
	_g_free0 (_tmp125_);
	_g_free0 (_tmp123_);
	_data5_->shutdown_button = _tmp127_;
	_tmp128_ = _data5_->shutdown_button;
	g_signal_connect_object ((GtkButton*) _tmp128_, "clicked", (GCallback) ___lambda22__gtk_button_clicked, self, 0);
	_tmp129_ = type;
	if (_tmp129_ != SHUTDOWN_DIALOG_TYPE_SHUTDOWN) {
		g_signal_connect_data ((GtkWidget*) self, "show", (GCallback) ____lambda23__gtk_widget_show, block5_data_ref (_data5_), (GClosureNotify) block5_data_unref, 0);
	}
	_tmp130_ = g_build_filename (PKGDATADIR, "dialog_close.png", NULL);
	_tmp131_ = _tmp130_;
	_tmp132_ = g_build_filename (PKGDATADIR, "dialog_close_highlight.png", NULL);
	_tmp133_ = _tmp132_;
	_tmp134_ = g_build_filename (PKGDATADIR, "dialog_close_press.png", NULL);
	_tmp135_ = _tmp134_;
	_tmp136_ = dialog_button_new (_tmp131_, _tmp133_, _tmp135_, NULL);
	g_object_ref_sink (_tmp136_);
	_g_object_unref0 (self->priv->close_button);
	self->priv->close_button = _tmp136_;
	_g_free0 (_tmp135_);
	_g_free0 (_tmp133_);
	_g_free0 (_tmp131_);
	_tmp137_ = self->priv->close_button;
	g_object_set ((GtkWidget*) _tmp137_, "can-focus", FALSE, NULL);
	_tmp138_ = self->priv->close_button;
	g_signal_connect_object ((GtkButton*) _tmp138_, "clicked", (GCallback) ___lambda24__gtk_button_clicked, self, 0);
	_tmp139_ = self->priv->close_button;
	gtk_widget_set_visible ((GtkWidget*) _tmp139_, TRUE);
	_tmp140_ = self->priv->close_button;
	gtk_container_add ((GtkContainer*) self, (GtkWidget*) _tmp140_);
	_tmp141_ = animate_timer_new (___lambda25__animate_timer_easing_func, self, ANIMATE_TIMER_INSTANT);
	_g_object_unref0 (self->priv->animation);
	self->priv->animation = _tmp141_;
	_tmp142_ = self->priv->animation;
	g_signal_connect_object (_tmp142_, "animate", (GCallback) ___lambda26__animate_timer_animate, self, 0);
	g_signal_connect_object ((GtkWidget*) self, "show", (GCallback) ___lambda27__gtk_widget_show, self, 0);
	_g_object_unref0 (restart_button);
	_g_object_unref0 (label);
	_g_free0 (text);
	block5_data_unref (_data5_);
	_data5_ = NULL;
	return self;
}


ShutdownDialog* shutdown_dialog_new (ShutdownDialogType type, Background* bg) {
	return shutdown_dialog_construct (TYPE_SHUTDOWN_DIALOG, type, bg);
}


gboolean shutdown_dialog_isNumber (ShutdownDialog* self, gdouble d) {
	gboolean result = FALSE;
	gdouble _tmp0_ = 0.0;
	gdouble _tmp1_ = 0.0;
	g_return_val_if_fail (self != NULL, FALSE);
	_tmp0_ = d;
	_tmp1_ = d;
	result = _tmp0_ == _tmp1_;
	return result;
}


static Block6Data* block6_data_ref (Block6Data* _data6_) {
	g_atomic_int_inc (&_data6_->_ref_count_);
	return _data6_;
}


static void block6_data_unref (void * _userdata_) {
	Block6Data* _data6_;
	_data6_ = (Block6Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data6_->_ref_count_)) {
		ShutdownDialog * self;
		self = _data6_->self;
		_g_object_unref0 (self);
		g_slice_free (Block6Data, _data6_);
	}
}


static gdouble __lambda16_ (Block6Data* _data6_, gdouble x) {
	ShutdownDialog * self;
	gdouble result = 0.0;
	gdouble _tmp0_ = 0.0;
	self = _data6_->self;
	_tmp0_ = x;
	result = _data6_->start_value + _tmp0_;
	return result;
}


static gdouble ___lambda16__animate_timer_easing_func (gdouble x, gpointer self) {
	gdouble result;
	result = __lambda16_ (self, x);
	return result;
}


static void __lambda17_ (ShutdownDialog* self, gdouble p) {
	gdouble _tmp0_ = 0.0;
	gboolean _tmp1_ = FALSE;
	gdouble _tmp2_ = 0.0;
	gboolean _tmp5_ = FALSE;
	gtk_widget_queue_draw ((GtkWidget*) self);
	_tmp0_ = p;
	g_debug ("shutdown-dialog.vala:256: ~~~~~~~~~close shutdown dialog animation = %" \
"f~~~~~~~~~~", _tmp0_);
	_tmp2_ = p;
	if (_tmp2_ >= ((gdouble) 0.98f)) {
		_tmp1_ = TRUE;
	} else {
		gdouble _tmp3_ = 0.0;
		gboolean _tmp4_ = FALSE;
		_tmp3_ = p;
		_tmp4_ = shutdown_dialog_isNumber (self, _tmp3_);
		_tmp1_ = !_tmp4_;
	}
	_tmp5_ = _tmp1_;
	if (_tmp5_) {
		AnimateTimer* _tmp6_ = NULL;
		_tmp6_ = self->priv->animation;
		animate_timer_stop (_tmp6_);
		g_signal_emit_by_name (self, "closed");
		g_debug ("shutdown-dialog.vala:261: ~~~~~~~~~close shutdown dialog closed!~~~~~~" \
"~~~~");
	}
}


static void ___lambda17__animate_timer_animate (AnimateTimer* _sender, gdouble progress, gpointer self) {
	__lambda17_ (self, progress);
}


void shutdown_dialog_close (ShutdownDialog* self) {
	Block6Data* _data6_;
	AnimateTimer* _tmp0_ = NULL;
	AnimateTimer* _tmp1_ = NULL;
	AnimateTimer* _tmp2_ = NULL;
	g_return_if_fail (self != NULL);
	_data6_ = g_slice_new0 (Block6Data);
	_data6_->_ref_count_ = 1;
	_data6_->self = g_object_ref (self);
	g_debug ("shutdown-dialog.vala:250: ~~~~~~~~~close shutdown dialog begin!~~~~~~~" \
"~~~");
	_data6_->start_value = 0.0f;
	_tmp0_ = animate_timer_new (___lambda16__animate_timer_easing_func, _data6_, ANIMATE_TIMER_INSTANT);
	_g_object_unref0 (self->priv->animation);
	self->priv->animation = _tmp0_;
	_tmp1_ = self->priv->animation;
	g_signal_connect_object (_tmp1_, "animate", (GCallback) ___lambda17__animate_timer_animate, self, 0);
	self->priv->closing = TRUE;
	_tmp2_ = self->priv->animation;
	animate_timer_reset (_tmp2_, -1);
	g_debug ("shutdown-dialog.vala:267: ~~~~~~~~~close shutdown dialog end!~~~~~~~~~" \
"~");
	block6_data_unref (_data6_);
	_data6_ = NULL;
}


static void shutdown_dialog_rebuild_background (ShutdownDialog* self) {
	g_return_if_fail (self != NULL);
	_cairo_surface_destroy0 (self->priv->bg_surface);
	self->priv->bg_surface = NULL;
	gtk_widget_queue_draw ((GtkWidget*) self);
}


static void shutdown_dialog_update_background_color (ShutdownDialog* self) {
	gdouble hue = 0.0;
	gdouble saturation = 0.0;
	gdouble value = 0.0;
	static const gdouble COLOR_ALPHA = (gdouble) 0.72f;
	GdkRGBA color = {0};
	Background* _tmp0_ = NULL;
	GdkRGBA _tmp1_ = {0};
	GdkRGBA _tmp2_ = {0};
	GdkRGBA _tmp3_ = {0};
	gdouble _tmp4_ = 0.0;
	GdkRGBA _tmp5_ = {0};
	gdouble _tmp6_ = 0.0;
	GdkRGBA _tmp7_ = {0};
	gdouble _tmp8_ = 0.0;
	gdouble _tmp9_ = 0.0;
	gdouble _tmp10_ = 0.0;
	gdouble _tmp11_ = 0.0;
	gdouble _tmp12_ = 0.0;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->background;
	background_get_average_color (_tmp0_, &_tmp1_);
	_tmp2_ = _tmp1_;
	color = _tmp2_;
	_tmp3_ = color;
	_tmp4_ = _tmp3_.red;
	_tmp5_ = color;
	_tmp6_ = _tmp5_.green;
	_tmp7_ = color;
	_tmp8_ = _tmp7_.blue;
	gtk_rgb_to_hsv (_tmp4_, _tmp6_, _tmp8_, &_tmp9_, &_tmp10_, &_tmp11_);
	hue = _tmp9_;
	saturation = _tmp10_;
	value = _tmp11_;
	_tmp12_ = saturation;
	if (_tmp12_ < 0.08) {
		GdkRGBA _tmp13_ = {0};
		_tmp13_.red = (gdouble) 0.18f;
		_tmp13_.green = (gdouble) 0.20f;
		_tmp13_.blue = (gdouble) 0.21f;
		_tmp13_.alpha = COLOR_ALPHA;
		self->priv->avg_color = _tmp13_;
	} else {
		static const GdkRGBA cmp_colors[] = {{(gdouble) (84 / 255.0f), (gdouble) (14 / 255.0f), (gdouble) (68 / 255.0f), (gdouble) 1.0f}, {(gdouble) (110 / 255.0f), (gdouble) (11 / 255.0f), (gdouble) (42 / 255.0f), (gdouble) 1.0f}, {(gdouble) (132 / 255.0f), (gdouble) (22 / 255.0f), (gdouble) (23 / 255.0f), (gdouble) 1.0f}, {(gdouble) (132 / 255.0f), (gdouble) (55 / 255.0f), (gdouble) (27 / 255.0f), (gdouble) 1.0f}, {(gdouble) (134 / 255.0f), (gdouble) (77 / 255.0f), (gdouble) (32 / 255.0f), (gdouble) 1.0f}, {(gdouble) (133 / 255.0f), (gdouble) (127 / 255.0f), (gdouble) (49 / 255.0f), (gdouble) 1.0f}, {(gdouble) (29 / 255.0f), (gdouble) (99 / 255.0f), (gdouble) (49 / 255.0f), (gdouble) 1.0f}, {(gdouble) (17 / 255.0f), (gdouble) (88 / 255.0f), (gdouble) (46 / 255.0f), (gdouble) 1.0f}, {(gdouble) (14 / 255.0f), (gdouble) (89 / 255.0f), (gdouble) (85 / 255.0f), (gdouble) 1.0f}, {(gdouble) (25 / 255.0f), (gdouble) (43 / 255.0f), (gdouble) (89 / 255.0f), (gdouble) 1.0f}, {(gdouble) (27 / 255.0f), (gdouble) (19 / 255.0f), (gdouble) (76 / 255.0f), (gdouble) 1.0f}, {(gdouble) (2 / 255.0f), (gdouble) (192 / 255.0f), (gdouble) (212 / 255.0f), (gdouble) 1.0f}};
		GdkRGBA _tmp14_ = {0};
		gdouble closest_diff = 0.0;
		gdouble new_hue = 0.0;
		gdouble new_saturation = 0.0;
		gdouble new_value = 0.0;
		GdkRGBA _tmp31_ = {0};
		gdouble _tmp32_ = 0.0;
		GdkRGBA _tmp33_ = {0};
		gdouble _tmp34_ = 0.0;
		GdkRGBA _tmp35_ = {0};
		gdouble _tmp36_ = 0.0;
		gdouble _tmp37_ = 0.0;
		gdouble _tmp38_ = 0.0;
		gdouble _tmp39_ = 0.0;
		gdouble _tmp40_ = 0.0;
		gdouble _tmp41_ = 0.0;
		gdouble _tmp42_ = 0.0;
		gdouble _tmp43_ = 0.0;
		gdouble _tmp44_ = 0.0;
		gdouble _tmp45_ = 0.0;
		gdouble _tmp46_ = 0.0;
		gdouble _tmp47_ = 0.0;
		gdouble _tmp48_ = 0.0;
		gdouble _tmp49_ = 0.0;
		gdouble _tmp50_ = 0.0;
		gdouble _tmp51_ = 0.0;
		gdouble _tmp52_ = 0.0;
		gdouble _tmp53_ = 0.0;
		gdouble _tmp54_ = 0.0;
		_tmp14_.red = (gdouble) 0;
		_tmp14_.green = (gdouble) 0;
		_tmp14_.blue = (gdouble) 0;
		_tmp14_.alpha = (gdouble) 1;
		self->priv->avg_color = _tmp14_;
		closest_diff = (gdouble) 200.0f;
		{
			GdkRGBA* c_collection = NULL;
			gint c_collection_length1 = 0;
			gint _c_collection_size_ = 0;
			gint c_it = 0;
			c_collection = cmp_colors;
			c_collection_length1 = G_N_ELEMENTS (cmp_colors);
			for (c_it = 0; c_it < G_N_ELEMENTS (cmp_colors); c_it = c_it + 1) {
				GdkRGBA c = {0};
				c = c_collection[c_it];
				{
					gdouble cmp_hue = 0.0;
					gdouble cmp_sat = 0.0;
					gdouble cmp_value = 0.0;
					GdkRGBA _tmp15_ = {0};
					gdouble _tmp16_ = 0.0;
					GdkRGBA _tmp17_ = {0};
					gdouble _tmp18_ = 0.0;
					GdkRGBA _tmp19_ = {0};
					gdouble _tmp20_ = 0.0;
					gdouble _tmp21_ = 0.0;
					gdouble _tmp22_ = 0.0;
					gdouble _tmp23_ = 0.0;
					gdouble color_diff = 0.0;
					gdouble _tmp24_ = 0.0;
					gdouble _tmp25_ = 0.0;
					gdouble _tmp26_ = 0.0;
					gdouble _tmp27_ = 0.0;
					gdouble _tmp28_ = 0.0;
					_tmp15_ = c;
					_tmp16_ = _tmp15_.red;
					_tmp17_ = c;
					_tmp18_ = _tmp17_.green;
					_tmp19_ = c;
					_tmp20_ = _tmp19_.blue;
					gtk_rgb_to_hsv (_tmp16_, _tmp18_, _tmp20_, &_tmp21_, &_tmp22_, &_tmp23_);
					cmp_hue = _tmp21_;
					cmp_sat = _tmp22_;
					cmp_value = _tmp23_;
					_tmp24_ = hue;
					_tmp25_ = cmp_hue;
					_tmp26_ = fabs (_tmp24_ - _tmp25_);
					color_diff = _tmp26_;
					_tmp27_ = color_diff;
					_tmp28_ = closest_diff;
					if (_tmp27_ < _tmp28_) {
						GdkRGBA _tmp29_ = {0};
						gdouble _tmp30_ = 0.0;
						_tmp29_ = c;
						self->priv->avg_color = _tmp29_;
						_tmp30_ = color_diff;
						closest_diff = _tmp30_;
					}
				}
			}
		}
		_tmp31_ = self->priv->avg_color;
		_tmp32_ = _tmp31_.red;
		_tmp33_ = self->priv->avg_color;
		_tmp34_ = _tmp33_.green;
		_tmp35_ = self->priv->avg_color;
		_tmp36_ = _tmp35_.blue;
		gtk_rgb_to_hsv (_tmp32_, _tmp34_, _tmp36_, &_tmp37_, &_tmp38_, &_tmp39_);
		new_hue = _tmp37_;
		new_saturation = _tmp38_;
		new_value = _tmp39_;
		_tmp40_ = saturation;
		_tmp41_ = new_saturation;
		_tmp42_ = MIN (_tmp40_, _tmp41_);
		saturation = _tmp42_;
		_tmp43_ = saturation;
		_tmp44_ = saturation;
		saturation = _tmp43_ * (2.0f - _tmp44_);
		_tmp45_ = value;
		_tmp46_ = new_value;
		_tmp47_ = MIN (_tmp45_, _tmp46_);
		_tmp48_ = MIN (_tmp47_, (gdouble) 0.26f);
		value = _tmp48_;
		_tmp49_ = hue;
		_tmp50_ = saturation;
		_tmp51_ = value;
		gtk_hsv_to_rgb (_tmp49_, _tmp50_, _tmp51_, &_tmp52_, &_tmp53_, &_tmp54_);
		self->priv->avg_color.red = _tmp52_;
		self->priv->avg_color.green = _tmp53_;
		self->priv->avg_color.blue = _tmp54_;
		self->priv->avg_color.alpha = COLOR_ALPHA;
	}
	shutdown_dialog_rebuild_background (self);
}


static gpointer _monitor_ref0 (gpointer self) {
	return self ? monitor_ref (self) : NULL;
}


void shutdown_dialog_set_active_monitor (ShutdownDialog* self, Monitor* m) {
	gboolean _tmp0_ = FALSE;
	Monitor* _tmp1_ = NULL;
	Monitor* _tmp2_ = NULL;
	gboolean _tmp6_ = FALSE;
	Monitor* _tmp7_ = NULL;
	Monitor* _tmp8_ = NULL;
	Monitor* _tmp9_ = NULL;
	gint _tmp10_ = 0;
	Monitor* _tmp11_ = NULL;
	gint _tmp12_ = 0;
	g_return_if_fail (self != NULL);
	g_return_if_fail (m != NULL);
	_tmp1_ = m;
	_tmp2_ = self->priv->monitor;
	if (_tmp1_ == _tmp2_) {
		_tmp0_ = TRUE;
	} else {
		Monitor* _tmp3_ = NULL;
		Monitor* _tmp4_ = NULL;
		gboolean _tmp5_ = FALSE;
		_tmp3_ = m;
		_tmp4_ = self->priv->monitor;
		_tmp5_ = monitor_equals (_tmp3_, _tmp4_);
		_tmp0_ = _tmp5_;
	}
	_tmp6_ = _tmp0_;
	if (_tmp6_) {
		return;
	}
	_tmp7_ = m;
	_tmp8_ = _monitor_ref0 (_tmp7_);
	_monitor_unref0 (self->priv->monitor);
	self->priv->monitor = _tmp8_;
	shutdown_dialog_rebuild_background (self);
	_tmp9_ = self->priv->monitor;
	_tmp10_ = _tmp9_->width;
	_tmp11_ = self->priv->monitor;
	_tmp12_ = _tmp11_->height;
	gtk_widget_set_size_request ((GtkWidget*) self, _tmp10_, _tmp12_);
}


void shutdown_dialog_focus_next (ShutdownDialog* self) {
	GtkWidget* _tmp0_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = gtk_widget_get_toplevel ((GtkWidget*) self);
	g_signal_emit_by_name ((GtkWidget*) (G_TYPE_CHECK_INSTANCE_TYPE (_tmp0_, GTK_TYPE_WINDOW) ? ((GtkWindow*) _tmp0_) : NULL), "move-focus", GTK_DIR_TAB_FORWARD);
}


void shutdown_dialog_focus_prev (ShutdownDialog* self) {
	GtkWidget* _tmp0_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = gtk_widget_get_toplevel ((GtkWidget*) self);
	g_signal_emit_by_name ((GtkWidget*) (G_TYPE_CHECK_INSTANCE_TYPE (_tmp0_, GTK_TYPE_WINDOW) ? ((GtkWindow*) _tmp0_) : NULL), "move-focus", GTK_DIR_TAB_BACKWARD);
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


void shutdown_dialog_cancel (ShutdownDialog* self) {
	GtkWidget* widget = NULL;
	GtkWidget* _tmp0_ = NULL;
	GtkWidget* _tmp1_ = NULL;
	GtkWidget* _tmp2_ = NULL;
	GtkWidget* _tmp3_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = gtk_widget_get_toplevel ((GtkWidget*) self);
	_tmp1_ = gtk_window_get_focus (G_TYPE_CHECK_INSTANCE_TYPE (_tmp0_, GTK_TYPE_WINDOW) ? ((GtkWindow*) _tmp0_) : NULL);
	_tmp2_ = _g_object_ref0 (_tmp1_);
	widget = _tmp2_;
	_tmp3_ = widget;
	if (G_TYPE_CHECK_INSTANCE_TYPE (_tmp3_, TYPE_DIALOG_BUTTON)) {
		GtkWidget* _tmp4_ = NULL;
		_tmp4_ = gtk_widget_get_toplevel ((GtkWidget*) self);
		gtk_window_set_focus (G_TYPE_CHECK_INSTANCE_TYPE (_tmp4_, GTK_TYPE_WINDOW) ? ((GtkWindow*) _tmp4_) : NULL, NULL);
	} else {
		shutdown_dialog_close (self);
	}
	_g_object_unref0 (widget);
}


static void shutdown_dialog_real_size_allocate (GtkWidget* base, GtkAllocation* allocation) {
	ShutdownDialog * self;
	GtkAllocation _tmp0_ = {0};
	GtkEventBox* _tmp1_ = NULL;
	GtkAllocation _tmp2_ = {0};
	GtkAllocation content_allocation = {0};
	gint minimum_width = 0;
	gint natural_width = 0;
	gint minimum_height = 0;
	gint natural_height = 0;
	GtkEventBox* _tmp3_ = NULL;
	gint _tmp4_ = 0;
	gint _tmp5_ = 0;
	GtkEventBox* _tmp6_ = NULL;
	gint _tmp7_ = 0;
	gint _tmp8_ = 0;
	gint _tmp9_ = 0;
	GtkAllocation _tmp10_ = {0};
	gint _tmp11_ = 0;
	GtkAllocation _tmp12_ = {0};
	gint _tmp13_ = 0;
	gint _tmp14_ = 0;
	GtkAllocation _tmp15_ = {0};
	gint _tmp16_ = 0;
	GtkAllocation _tmp17_ = {0};
	gint _tmp18_ = 0;
	gint _tmp19_ = 0;
	gint _tmp20_ = 0;
	gint _tmp21_ = 0;
	GtkEventBox* _tmp22_ = NULL;
	GtkAllocation _tmp23_ = {0};
	GtkAllocation a = {0};
	DialogButton* _tmp24_ = NULL;
	gint _tmp25_ = 0;
	gint _tmp26_ = 0;
	DialogButton* _tmp27_ = NULL;
	gint _tmp28_ = 0;
	gint _tmp29_ = 0;
	GtkAllocation _tmp30_ = {0};
	gint _tmp31_ = 0;
	GtkAllocation _tmp32_ = {0};
	gint _tmp33_ = 0;
	gint _tmp34_ = 0;
	gint _tmp35_ = 0;
	DialogButton* _tmp36_ = NULL;
	GtkAllocation _tmp37_ = {0};
	self = (ShutdownDialog*) base;
	g_return_if_fail (allocation != NULL);
	_tmp0_ = *allocation;
	GTK_WIDGET_CLASS (shutdown_dialog_parent_class)->size_allocate ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, GTK_TYPE_FIXED, GtkFixed), &_tmp0_);
	_tmp1_ = self->priv->monitor_events;
	_tmp2_ = *allocation;
	gtk_widget_size_allocate ((GtkWidget*) _tmp1_, &_tmp2_);
	memset (&content_allocation, 0, sizeof (GtkAllocation));
	_tmp3_ = self->priv->vbox_events;
	gtk_widget_get_preferred_width ((GtkWidget*) _tmp3_, &_tmp4_, &_tmp5_);
	minimum_width = _tmp4_;
	natural_width = _tmp5_;
	_tmp6_ = self->priv->vbox_events;
	_tmp7_ = minimum_width;
	gtk_widget_get_preferred_height_for_width ((GtkWidget*) _tmp6_, _tmp7_, &_tmp8_, &_tmp9_);
	minimum_height = _tmp8_;
	natural_height = _tmp9_;
	_tmp10_ = *allocation;
	_tmp11_ = _tmp10_.x;
	_tmp12_ = *allocation;
	_tmp13_ = _tmp12_.width;
	_tmp14_ = minimum_width;
	content_allocation.x = _tmp11_ + ((_tmp13_ - _tmp14_) / 2);
	_tmp15_ = *allocation;
	_tmp16_ = _tmp15_.y;
	_tmp17_ = *allocation;
	_tmp18_ = _tmp17_.height;
	_tmp19_ = minimum_height;
	content_allocation.y = _tmp16_ + ((_tmp18_ - _tmp19_) / 2);
	_tmp20_ = minimum_width;
	content_allocation.width = _tmp20_;
	_tmp21_ = minimum_height;
	content_allocation.height = _tmp21_;
	_tmp22_ = self->priv->vbox_events;
	_tmp23_ = content_allocation;
	gtk_widget_size_allocate ((GtkWidget*) _tmp22_, &_tmp23_);
	memset (&a, 0, sizeof (GtkAllocation));
	_tmp24_ = self->priv->close_button;
	gtk_widget_get_preferred_width ((GtkWidget*) _tmp24_, &_tmp25_, &_tmp26_);
	minimum_width = _tmp25_;
	natural_width = _tmp26_;
	_tmp27_ = self->priv->close_button;
	gtk_widget_get_preferred_height ((GtkWidget*) _tmp27_, &_tmp28_, &_tmp29_);
	minimum_height = _tmp28_;
	natural_height = _tmp29_;
	_tmp30_ = content_allocation;
	_tmp31_ = _tmp30_.x;
	a.x = (_tmp31_ - SHUTDOWN_DIALOG_BORDER_EXTERNAL_SIZE) + SHUTDOWN_DIALOG_CLOSE_OFFSET;
	_tmp32_ = content_allocation;
	_tmp33_ = _tmp32_.y;
	a.y = (_tmp33_ - SHUTDOWN_DIALOG_BORDER_EXTERNAL_SIZE) + SHUTDOWN_DIALOG_CLOSE_OFFSET;
	_tmp34_ = minimum_width;
	a.width = _tmp34_;
	_tmp35_ = minimum_height;
	a.height = _tmp35_;
	_tmp36_ = self->priv->close_button;
	_tmp37_ = a;
	gtk_widget_size_allocate ((GtkWidget*) _tmp36_, &_tmp37_);
}


static gboolean shutdown_dialog_real_draw (GtkWidget* base, cairo_t* c) {
	ShutdownDialog * self;
	gboolean result = FALSE;
	cairo_surface_t* _tmp0_ = NULL;
	gint width = 0;
	GtkEventBox* _tmp18_ = NULL;
	gint _tmp19_ = 0;
	gint height = 0;
	GtkEventBox* _tmp20_ = NULL;
	gint _tmp21_ = 0;
	gint x = 0;
	gint _tmp22_ = 0;
	gint _tmp23_ = 0;
	gint y = 0;
	gint _tmp24_ = 0;
	gint _tmp25_ = 0;
	AnimateTimer* _tmp26_ = NULL;
	gboolean _tmp27_ = FALSE;
	gboolean _tmp28_ = FALSE;
	cairo_t* _tmp30_ = NULL;
	cairo_t* _tmp31_ = NULL;
	gboolean _tmp32_ = FALSE;
	cairo_surface_t* _tmp33_ = NULL;
	gboolean _tmp37_ = FALSE;
	cairo_t* _tmp57_ = NULL;
	cairo_t* _tmp58_ = NULL;
	gint _tmp59_ = 0;
	gint _tmp60_ = 0;
	cairo_t* _tmp61_ = NULL;
	gint _tmp62_ = 0;
	gint _tmp63_ = 0;
	cairo_t* _tmp64_ = NULL;
	cairo_surface_t* _tmp65_ = NULL;
	cairo_t* _tmp66_ = NULL;
	cairo_t* _tmp67_ = NULL;
	GdkRGBA _tmp68_ = {0};
	gdouble _tmp69_ = 0.0;
	GdkRGBA _tmp70_ = {0};
	gdouble _tmp71_ = 0.0;
	GdkRGBA _tmp72_ = {0};
	gdouble _tmp73_ = 0.0;
	GdkRGBA _tmp74_ = {0};
	gdouble _tmp75_ = 0.0;
	cairo_t* _tmp76_ = NULL;
	cairo_t* _tmp77_ = NULL;
	gint _tmp78_ = 0;
	gint _tmp79_ = 0;
	gint _tmp80_ = 0;
	gint _tmp81_ = 0;
	cairo_t* _tmp82_ = NULL;
	cairo_t* _tmp83_ = NULL;
	gint _tmp84_ = 0;
	gint _tmp85_ = 0;
	cairo_matrix_t m = {0};
	cairo_pattern_t* _tmp86_ = NULL;
	cairo_matrix_t _tmp87_ = {0};
	cairo_t* _tmp88_ = NULL;
	cairo_pattern_t* _tmp89_ = NULL;
	cairo_t* _tmp90_ = NULL;
	cairo_t* _tmp91_ = NULL;
	gint _tmp92_ = 0;
	cairo_pattern_t* _tmp93_ = NULL;
	cairo_matrix_t _tmp94_ = {0};
	cairo_t* _tmp95_ = NULL;
	cairo_pattern_t* _tmp96_ = NULL;
	cairo_t* _tmp97_ = NULL;
	gint _tmp98_ = 0;
	cairo_t* _tmp99_ = NULL;
	gint _tmp100_ = 0;
	cairo_pattern_t* _tmp101_ = NULL;
	cairo_matrix_t _tmp102_ = {0};
	cairo_t* _tmp103_ = NULL;
	cairo_pattern_t* _tmp104_ = NULL;
	cairo_t* _tmp105_ = NULL;
	gint _tmp106_ = 0;
	cairo_t* _tmp107_ = NULL;
	gint _tmp108_ = 0;
	gint _tmp109_ = 0;
	cairo_pattern_t* _tmp110_ = NULL;
	cairo_matrix_t _tmp111_ = {0};
	cairo_t* _tmp112_ = NULL;
	cairo_pattern_t* _tmp113_ = NULL;
	cairo_t* _tmp114_ = NULL;
	gint _tmp115_ = 0;
	gint _tmp116_ = 0;
	cairo_t* _tmp117_ = NULL;
	cairo_pattern_t* _tmp118_ = NULL;
	cairo_matrix_t _tmp119_ = {0};
	cairo_t* _tmp120_ = NULL;
	cairo_pattern_t* _tmp121_ = NULL;
	cairo_t* _tmp122_ = NULL;
	gint _tmp123_ = 0;
	cairo_t* _tmp124_ = NULL;
	gint _tmp125_ = 0;
	cairo_pattern_t* _tmp126_ = NULL;
	cairo_matrix_t _tmp127_ = {0};
	cairo_t* _tmp128_ = NULL;
	cairo_pattern_t* _tmp129_ = NULL;
	cairo_t* _tmp130_ = NULL;
	gint _tmp131_ = 0;
	gint _tmp132_ = 0;
	cairo_t* _tmp133_ = NULL;
	cairo_pattern_t* _tmp134_ = NULL;
	cairo_matrix_t _tmp135_ = {0};
	cairo_t* _tmp136_ = NULL;
	cairo_pattern_t* _tmp137_ = NULL;
	cairo_t* _tmp138_ = NULL;
	gint _tmp139_ = 0;
	cairo_t* _tmp140_ = NULL;
	gint _tmp141_ = 0;
	cairo_pattern_t* _tmp142_ = NULL;
	cairo_matrix_t _tmp143_ = {0};
	cairo_t* _tmp144_ = NULL;
	cairo_pattern_t* _tmp145_ = NULL;
	cairo_t* _tmp146_ = NULL;
	gint _tmp147_ = 0;
	gint _tmp148_ = 0;
	cairo_t* _tmp149_ = NULL;
	cairo_t* _tmp150_ = NULL;
	gboolean ret = FALSE;
	cairo_t* _tmp151_ = NULL;
	gboolean _tmp152_ = FALSE;
	AnimateTimer* _tmp153_ = NULL;
	gboolean _tmp154_ = FALSE;
	gboolean _tmp155_ = FALSE;
	self = (ShutdownDialog*) base;
	g_return_val_if_fail (c != NULL, FALSE);
	_tmp0_ = self->priv->corner_surface;
	if (_tmp0_ == NULL) {
		gchar* _tmp1_ = NULL;
		gchar* _tmp2_ = NULL;
		cairo_surface_t* _tmp3_ = NULL;
		gchar* _tmp4_ = NULL;
		gchar* _tmp5_ = NULL;
		cairo_surface_t* _tmp6_ = NULL;
		gchar* _tmp7_ = NULL;
		gchar* _tmp8_ = NULL;
		cairo_surface_t* _tmp9_ = NULL;
		cairo_surface_t* _tmp10_ = NULL;
		cairo_pattern_t* _tmp11_ = NULL;
		cairo_surface_t* _tmp12_ = NULL;
		cairo_pattern_t* _tmp13_ = NULL;
		cairo_pattern_t* _tmp14_ = NULL;
		cairo_surface_t* _tmp15_ = NULL;
		cairo_pattern_t* _tmp16_ = NULL;
		cairo_pattern_t* _tmp17_ = NULL;
		_tmp1_ = g_build_filename (PKGDATADIR, "switcher_corner.png", NULL);
		_tmp2_ = _tmp1_;
		_tmp3_ = cairo_image_surface_create_from_png (_tmp2_);
		_cairo_surface_destroy0 (self->priv->corner_surface);
		self->priv->corner_surface = _tmp3_;
		_g_free0 (_tmp2_);
		_tmp4_ = g_build_filename (PKGDATADIR, "switcher_left.png", NULL);
		_tmp5_ = _tmp4_;
		_tmp6_ = cairo_image_surface_create_from_png (_tmp5_);
		_cairo_surface_destroy0 (self->priv->left_surface);
		self->priv->left_surface = _tmp6_;
		_g_free0 (_tmp5_);
		_tmp7_ = g_build_filename (PKGDATADIR, "switcher_top.png", NULL);
		_tmp8_ = _tmp7_;
		_tmp9_ = cairo_image_surface_create_from_png (_tmp8_);
		_cairo_surface_destroy0 (self->priv->top_surface);
		self->priv->top_surface = _tmp9_;
		_g_free0 (_tmp8_);
		_tmp10_ = self->priv->corner_surface;
		_tmp11_ = cairo_pattern_create_for_surface (_tmp10_);
		_cairo_pattern_destroy0 (self->priv->corner_pattern);
		self->priv->corner_pattern = _tmp11_;
		_tmp12_ = self->priv->left_surface;
		_tmp13_ = cairo_pattern_create_for_surface (_tmp12_);
		_cairo_pattern_destroy0 (self->priv->left_pattern);
		self->priv->left_pattern = _tmp13_;
		_tmp14_ = self->priv->left_pattern;
		cairo_pattern_set_extend (_tmp14_, CAIRO_EXTEND_REPEAT);
		_tmp15_ = self->priv->top_surface;
		_tmp16_ = cairo_pattern_create_for_surface (_tmp15_);
		_cairo_pattern_destroy0 (self->priv->top_pattern);
		self->priv->top_pattern = _tmp16_;
		_tmp17_ = self->priv->top_pattern;
		cairo_pattern_set_extend (_tmp17_, CAIRO_EXTEND_REPEAT);
	}
	_tmp18_ = self->priv->vbox_events;
	_tmp19_ = gtk_widget_get_allocated_width ((GtkWidget*) _tmp18_);
	width = _tmp19_;
	_tmp20_ = self->priv->vbox_events;
	_tmp21_ = gtk_widget_get_allocated_height ((GtkWidget*) _tmp20_);
	height = _tmp21_;
	_tmp22_ = gtk_widget_get_allocated_width ((GtkWidget*) self);
	_tmp23_ = width;
	x = (_tmp22_ - _tmp23_) / 2;
	_tmp24_ = gtk_widget_get_allocated_height ((GtkWidget*) self);
	_tmp25_ = height;
	y = (_tmp24_ - _tmp25_) / 2;
	_tmp26_ = self->priv->animation;
	_tmp27_ = animate_timer_get_is_running (_tmp26_);
	_tmp28_ = _tmp27_;
	if (_tmp28_) {
		cairo_t* _tmp29_ = NULL;
		_tmp29_ = c;
		cairo_push_group (_tmp29_);
	}
	_tmp30_ = c;
	cairo_set_source_rgba (_tmp30_, (gdouble) 0, (gdouble) 0, (gdouble) 0, 0.25);
	_tmp31_ = c;
	cairo_paint (_tmp31_);
	_tmp33_ = self->priv->bg_surface;
	if (_tmp33_ == NULL) {
		_tmp32_ = TRUE;
	} else {
		AnimateTimer* _tmp34_ = NULL;
		gboolean _tmp35_ = FALSE;
		gboolean _tmp36_ = FALSE;
		_tmp34_ = self->priv->animation;
		_tmp35_ = animate_timer_get_is_running (_tmp34_);
		_tmp36_ = _tmp35_;
		_tmp32_ = _tmp36_;
	}
	_tmp37_ = _tmp32_;
	if (_tmp37_) {
		gint _tmp38_ = 0;
		gint _tmp39_ = 0;
		cairo_surface_t* _tmp40_ = NULL;
		cairo_t* bg_cr = NULL;
		cairo_surface_t* _tmp41_ = NULL;
		cairo_t* _tmp42_ = NULL;
		cairo_t* _tmp43_ = NULL;
		cairo_t* _tmp44_ = NULL;
		cairo_surface_t* _tmp45_ = NULL;
		gint _tmp46_ = 0;
		Monitor* _tmp47_ = NULL;
		gint _tmp48_ = 0;
		gint _tmp49_ = 0;
		Monitor* _tmp50_ = NULL;
		gint _tmp51_ = 0;
		cairo_t* _tmp52_ = NULL;
		gint _tmp53_ = 0;
		gint _tmp54_ = 0;
		cairo_t* _tmp55_ = NULL;
		cairo_surface_t* _tmp56_ = NULL;
		_tmp38_ = width;
		_tmp39_ = height;
		_tmp40_ = cairo_image_surface_create (CAIRO_FORMAT_ARGB32, _tmp38_, _tmp39_);
		_cairo_surface_destroy0 (self->priv->bg_surface);
		self->priv->bg_surface = _tmp40_;
		_tmp41_ = self->priv->bg_surface;
		_tmp42_ = cairo_create (_tmp41_);
		bg_cr = _tmp42_;
		_tmp43_ = bg_cr;
		_tmp44_ = c;
		_tmp45_ = cairo_get_target (_tmp44_);
		_tmp46_ = x;
		_tmp47_ = self->priv->monitor;
		_tmp48_ = _tmp47_->x;
		_tmp49_ = y;
		_tmp50_ = self->priv->monitor;
		_tmp51_ = _tmp50_->y;
		cairo_set_source_surface (_tmp43_, _tmp45_, (gdouble) ((-_tmp46_) - _tmp48_), (gdouble) ((-_tmp49_) - _tmp51_));
		_tmp52_ = bg_cr;
		_tmp53_ = width;
		_tmp54_ = height;
		cairo_rectangle (_tmp52_, (gdouble) 0, (gdouble) 0, (gdouble) _tmp53_, (gdouble) _tmp54_);
		_tmp55_ = bg_cr;
		cairo_fill (_tmp55_);
		_tmp56_ = self->priv->bg_surface;
		cairo_utils_exponential_blur_surface (_tmp56_, SHUTDOWN_DIALOG_BLUR_RADIUS);
		_cairo_destroy0 (bg_cr);
	}
	_tmp57_ = c;
	cairo_save (_tmp57_);
	_tmp58_ = c;
	_tmp59_ = x;
	_tmp60_ = y;
	cairo_translate (_tmp58_, (gdouble) _tmp59_, (gdouble) _tmp60_);
	_tmp61_ = c;
	_tmp62_ = width;
	_tmp63_ = height;
	cairo_utils_rounded_rectangle (_tmp61_, (gdouble) 0, (gdouble) 0, (gdouble) _tmp62_, (gdouble) _tmp63_, (gdouble) 4);
	_tmp64_ = c;
	_tmp65_ = self->priv->bg_surface;
	cairo_set_source_surface (_tmp64_, _tmp65_, (gdouble) 0, (gdouble) 0);
	_tmp66_ = c;
	cairo_fill_preserve (_tmp66_);
	_tmp67_ = c;
	_tmp68_ = self->priv->avg_color;
	_tmp69_ = _tmp68_.red;
	_tmp70_ = self->priv->avg_color;
	_tmp71_ = _tmp70_.green;
	_tmp72_ = self->priv->avg_color;
	_tmp73_ = _tmp72_.blue;
	_tmp74_ = self->priv->avg_color;
	_tmp75_ = _tmp74_.alpha;
	cairo_set_source_rgba (_tmp67_, _tmp69_, _tmp71_, _tmp73_, _tmp75_);
	_tmp76_ = c;
	cairo_fill (_tmp76_);
	_tmp77_ = c;
	cairo_restore (_tmp77_);
	_tmp78_ = x;
	x = _tmp78_ - SHUTDOWN_DIALOG_BORDER_EXTERNAL_SIZE;
	_tmp79_ = y;
	y = _tmp79_ - SHUTDOWN_DIALOG_BORDER_EXTERNAL_SIZE;
	_tmp80_ = width;
	width = _tmp80_ + (SHUTDOWN_DIALOG_BORDER_EXTERNAL_SIZE * 2);
	_tmp81_ = height;
	height = _tmp81_ + (SHUTDOWN_DIALOG_BORDER_EXTERNAL_SIZE * 2);
	_tmp82_ = c;
	cairo_save (_tmp82_);
	_tmp83_ = c;
	_tmp84_ = x;
	_tmp85_ = y;
	cairo_translate (_tmp83_, (gdouble) _tmp84_, (gdouble) _tmp85_);
	cairo_matrix_init_identity (&m);
	_tmp86_ = self->priv->corner_pattern;
	_tmp87_ = m;
	cairo_pattern_set_matrix (_tmp86_, &_tmp87_);
	_tmp88_ = c;
	_tmp89_ = self->priv->corner_pattern;
	cairo_set_source (_tmp88_, _tmp89_);
	_tmp90_ = c;
	cairo_rectangle (_tmp90_, (gdouble) 0, (gdouble) 0, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE);
	_tmp91_ = c;
	cairo_fill (_tmp91_);
	cairo_matrix_init_identity (&m);
	_tmp92_ = width;
	cairo_matrix_translate (&m, (gdouble) _tmp92_, (gdouble) 0);
	cairo_matrix_scale (&m, (gdouble) (-1), (gdouble) 1);
	_tmp93_ = self->priv->corner_pattern;
	_tmp94_ = m;
	cairo_pattern_set_matrix (_tmp93_, &_tmp94_);
	_tmp95_ = c;
	_tmp96_ = self->priv->corner_pattern;
	cairo_set_source (_tmp95_, _tmp96_);
	_tmp97_ = c;
	_tmp98_ = width;
	cairo_rectangle (_tmp97_, (gdouble) (_tmp98_ - SHUTDOWN_DIALOG_BORDER_SIZE), (gdouble) 0, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE);
	_tmp99_ = c;
	cairo_fill (_tmp99_);
	cairo_matrix_init_identity (&m);
	_tmp100_ = height;
	cairo_matrix_translate (&m, (gdouble) 0, (gdouble) _tmp100_);
	cairo_matrix_scale (&m, (gdouble) 1, (gdouble) (-1));
	_tmp101_ = self->priv->corner_pattern;
	_tmp102_ = m;
	cairo_pattern_set_matrix (_tmp101_, &_tmp102_);
	_tmp103_ = c;
	_tmp104_ = self->priv->corner_pattern;
	cairo_set_source (_tmp103_, _tmp104_);
	_tmp105_ = c;
	_tmp106_ = height;
	cairo_rectangle (_tmp105_, (gdouble) 0, (gdouble) (_tmp106_ - SHUTDOWN_DIALOG_BORDER_SIZE), (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE);
	_tmp107_ = c;
	cairo_fill (_tmp107_);
	cairo_matrix_init_identity (&m);
	_tmp108_ = width;
	_tmp109_ = height;
	cairo_matrix_translate (&m, (gdouble) _tmp108_, (gdouble) _tmp109_);
	cairo_matrix_scale (&m, (gdouble) (-1), (gdouble) (-1));
	_tmp110_ = self->priv->corner_pattern;
	_tmp111_ = m;
	cairo_pattern_set_matrix (_tmp110_, &_tmp111_);
	_tmp112_ = c;
	_tmp113_ = self->priv->corner_pattern;
	cairo_set_source (_tmp112_, _tmp113_);
	_tmp114_ = c;
	_tmp115_ = width;
	_tmp116_ = height;
	cairo_rectangle (_tmp114_, (gdouble) (_tmp115_ - SHUTDOWN_DIALOG_BORDER_SIZE), (gdouble) (_tmp116_ - SHUTDOWN_DIALOG_BORDER_SIZE), (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE);
	_tmp117_ = c;
	cairo_fill (_tmp117_);
	cairo_matrix_init_identity (&m);
	_tmp118_ = self->priv->left_pattern;
	_tmp119_ = m;
	cairo_pattern_set_matrix (_tmp118_, &_tmp119_);
	_tmp120_ = c;
	_tmp121_ = self->priv->left_pattern;
	cairo_set_source (_tmp120_, _tmp121_);
	_tmp122_ = c;
	_tmp123_ = height;
	cairo_rectangle (_tmp122_, (gdouble) 0, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE, (gdouble) (_tmp123_ - (SHUTDOWN_DIALOG_BORDER_SIZE * 2)));
	_tmp124_ = c;
	cairo_fill (_tmp124_);
	cairo_matrix_init_identity (&m);
	_tmp125_ = width;
	cairo_matrix_translate (&m, (gdouble) _tmp125_, (gdouble) 0);
	cairo_matrix_scale (&m, (gdouble) (-1), (gdouble) 1);
	_tmp126_ = self->priv->left_pattern;
	_tmp127_ = m;
	cairo_pattern_set_matrix (_tmp126_, &_tmp127_);
	_tmp128_ = c;
	_tmp129_ = self->priv->left_pattern;
	cairo_set_source (_tmp128_, _tmp129_);
	_tmp130_ = c;
	_tmp131_ = width;
	_tmp132_ = height;
	cairo_rectangle (_tmp130_, (gdouble) (_tmp131_ - SHUTDOWN_DIALOG_BORDER_SIZE), (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE, (gdouble) (_tmp132_ - (SHUTDOWN_DIALOG_BORDER_SIZE * 2)));
	_tmp133_ = c;
	cairo_fill (_tmp133_);
	cairo_matrix_init_identity (&m);
	_tmp134_ = self->priv->top_pattern;
	_tmp135_ = m;
	cairo_pattern_set_matrix (_tmp134_, &_tmp135_);
	_tmp136_ = c;
	_tmp137_ = self->priv->top_pattern;
	cairo_set_source (_tmp136_, _tmp137_);
	_tmp138_ = c;
	_tmp139_ = width;
	cairo_rectangle (_tmp138_, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE, (gdouble) 0, (gdouble) (_tmp139_ - (SHUTDOWN_DIALOG_BORDER_SIZE * 2)), (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE);
	_tmp140_ = c;
	cairo_fill (_tmp140_);
	cairo_matrix_init_identity (&m);
	_tmp141_ = height;
	cairo_matrix_translate (&m, (gdouble) 0, (gdouble) _tmp141_);
	cairo_matrix_scale (&m, (gdouble) 1, (gdouble) (-1));
	_tmp142_ = self->priv->top_pattern;
	_tmp143_ = m;
	cairo_pattern_set_matrix (_tmp142_, &_tmp143_);
	_tmp144_ = c;
	_tmp145_ = self->priv->top_pattern;
	cairo_set_source (_tmp144_, _tmp145_);
	_tmp146_ = c;
	_tmp147_ = height;
	_tmp148_ = width;
	cairo_rectangle (_tmp146_, (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE, (gdouble) (_tmp147_ - SHUTDOWN_DIALOG_BORDER_SIZE), (gdouble) (_tmp148_ - (SHUTDOWN_DIALOG_BORDER_SIZE * 2)), (gdouble) SHUTDOWN_DIALOG_BORDER_SIZE);
	_tmp149_ = c;
	cairo_fill (_tmp149_);
	_tmp150_ = c;
	cairo_restore (_tmp150_);
	_tmp151_ = c;
	_tmp152_ = GTK_WIDGET_CLASS (shutdown_dialog_parent_class)->draw ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, GTK_TYPE_FIXED, GtkFixed), _tmp151_);
	ret = _tmp152_;
	_tmp153_ = self->priv->animation;
	_tmp154_ = animate_timer_get_is_running (_tmp153_);
	_tmp155_ = _tmp154_;
	if (_tmp155_) {
		cairo_t* _tmp156_ = NULL;
		gdouble _tmp157_ = 0.0;
		gboolean _tmp158_ = FALSE;
		cairo_t* _tmp165_ = NULL;
		gdouble _tmp166_ = 0.0;
		_tmp156_ = c;
		cairo_pop_group_to_source (_tmp156_);
		_tmp158_ = self->priv->closing;
		if (_tmp158_) {
			AnimateTimer* _tmp159_ = NULL;
			gdouble _tmp160_ = 0.0;
			gdouble _tmp161_ = 0.0;
			_tmp159_ = self->priv->animation;
			_tmp160_ = animate_timer_get_progress (_tmp159_);
			_tmp161_ = _tmp160_;
			_tmp157_ = 1.0f - _tmp161_;
		} else {
			AnimateTimer* _tmp162_ = NULL;
			gdouble _tmp163_ = 0.0;
			gdouble _tmp164_ = 0.0;
			_tmp162_ = self->priv->animation;
			_tmp163_ = animate_timer_get_progress (_tmp162_);
			_tmp164_ = _tmp163_;
			_tmp157_ = _tmp164_;
		}
		_tmp165_ = c;
		_tmp166_ = _tmp157_;
		cairo_paint_with_alpha (_tmp165_, _tmp166_);
	}
	result = ret;
	return result;
}


static DialogButton* shutdown_dialog_add_button (ShutdownDialog* self, const gchar* text, const gchar* inactive_filename, const gchar* active_filename) {
	DialogButton* result = NULL;
	GtkBox* b = NULL;
	GtkBox* _tmp0_ = NULL;
	GtkBox* _tmp1_ = NULL;
	GtkLabel* label = NULL;
	const gchar* _tmp2_ = NULL;
	GtkLabel* _tmp3_ = NULL;
	DialogButton* button = NULL;
	const gchar* _tmp4_ = NULL;
	const gchar* _tmp5_ = NULL;
	DialogButton* _tmp6_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (text != NULL, NULL);
	g_return_val_if_fail (inactive_filename != NULL, NULL);
	g_return_val_if_fail (active_filename != NULL, NULL);
	_tmp0_ = (GtkBox*) gtk_box_new (GTK_ORIENTATION_VERTICAL, SHUTDOWN_DIALOG_BUTTON_TEXT_SPACE);
	g_object_ref_sink (_tmp0_);
	b = _tmp0_;
	gtk_widget_set_visible ((GtkWidget*) b, TRUE);
	_tmp1_ = self->priv->button_box;
	gtk_box_pack_start (_tmp1_, (GtkWidget*) b, FALSE, FALSE, (guint) 0);
	_tmp2_ = text;
	_tmp3_ = (GtkLabel*) gtk_label_new (_tmp2_);
	g_object_ref_sink (_tmp3_);
	label = _tmp3_;
	_tmp4_ = inactive_filename;
	_tmp5_ = active_filename;
	_tmp6_ = dialog_button_new (_tmp4_, _tmp5_, NULL, label);
	g_object_ref_sink (_tmp6_);
	button = _tmp6_;
	gtk_widget_set_visible ((GtkWidget*) button, TRUE);
	gtk_box_pack_start (b, (GtkWidget*) button, FALSE, FALSE, (guint) 0);
	gtk_box_pack_start (b, (GtkWidget*) label, FALSE, FALSE, (guint) 0);
	result = button;
	_g_object_unref0 (label);
	_g_object_unref0 (b);
	return result;
}


static void shutdown_dialog_class_init (ShutdownDialogClass * klass) {
	shutdown_dialog_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (ShutdownDialogPrivate));
	GTK_WIDGET_CLASS (klass)->size_allocate = shutdown_dialog_real_size_allocate;
	GTK_WIDGET_CLASS (klass)->draw = shutdown_dialog_real_draw;
	G_OBJECT_CLASS (klass)->finalize = shutdown_dialog_finalize;
	g_signal_new ("closed", TYPE_SHUTDOWN_DIALOG, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__VOID, G_TYPE_NONE, 0);
}


static void shutdown_dialog_instance_init (ShutdownDialog * self) {
	self->priv = SHUTDOWN_DIALOG_GET_PRIVATE (self);
	self->priv->bg_surface = NULL;
	self->priv->corner_surface = NULL;
	self->priv->left_surface = NULL;
	self->priv->top_surface = NULL;
	self->priv->corner_pattern = NULL;
	self->priv->left_pattern = NULL;
	self->priv->top_pattern = NULL;
	self->priv->closing = FALSE;
}


static void shutdown_dialog_finalize (GObject* obj) {
	ShutdownDialog * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, TYPE_SHUTDOWN_DIALOG, ShutdownDialog);
	_cairo_surface_destroy0 (self->priv->bg_surface);
	_cairo_surface_destroy0 (self->priv->corner_surface);
	_cairo_surface_destroy0 (self->priv->left_surface);
	_cairo_surface_destroy0 (self->priv->top_surface);
	_cairo_pattern_destroy0 (self->priv->corner_pattern);
	_cairo_pattern_destroy0 (self->priv->left_pattern);
	_cairo_pattern_destroy0 (self->priv->top_pattern);
	_monitor_unref0 (self->priv->monitor);
	_g_object_unref0 (self->priv->vbox);
	_g_object_unref0 (self->priv->close_button);
	_g_object_unref0 (self->priv->button_box);
	_g_object_unref0 (self->priv->monitor_events);
	_g_object_unref0 (self->priv->vbox_events);
	_g_object_unref0 (self->priv->animation);
	G_OBJECT_CLASS (shutdown_dialog_parent_class)->finalize (obj);
}


GType shutdown_dialog_get_type (void) {
	static volatile gsize shutdown_dialog_type_id__volatile = 0;
	if (g_once_init_enter (&shutdown_dialog_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (ShutdownDialogClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) shutdown_dialog_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ShutdownDialog), 0, (GInstanceInitFunc) shutdown_dialog_instance_init, NULL };
		GType shutdown_dialog_type_id;
		shutdown_dialog_type_id = g_type_register_static (GTK_TYPE_FIXED, "ShutdownDialog", &g_define_type_info, 0);
		g_once_init_leave (&shutdown_dialog_type_id__volatile, shutdown_dialog_type_id);
	}
	return shutdown_dialog_type_id__volatile;
}


DialogButton* dialog_button_construct (GType object_type, const gchar* inactive_filename, const gchar* focused_filename, const gchar* active_filename, GtkLabel* label) {
	DialogButton * self = NULL;
	const gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	const gchar* _tmp2_ = NULL;
	gchar* _tmp3_ = NULL;
	const gchar* _tmp4_ = NULL;
	gchar* _tmp5_ = NULL;
	const gchar* _tmp6_ = NULL;
	GtkImage* _tmp7_ = NULL;
	GtkImage* _tmp8_ = NULL;
	GtkImage* _tmp9_ = NULL;
	GtkLabel* _tmp10_ = NULL;
	GtkLabel* _tmp11_ = NULL;
	GtkLabel* _tmp12_ = NULL;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (inactive_filename != NULL, NULL);
	g_return_val_if_fail (focused_filename != NULL, NULL);
	self = (DialogButton*) g_object_new (object_type, NULL);
	_tmp0_ = inactive_filename;
	_tmp1_ = g_strdup (_tmp0_);
	_g_free0 (self->priv->inactive_filename);
	self->priv->inactive_filename = _tmp1_;
	_tmp2_ = focused_filename;
	_tmp3_ = g_strdup (_tmp2_);
	_g_free0 (self->priv->focused_filename);
	self->priv->focused_filename = _tmp3_;
	_tmp4_ = active_filename;
	_tmp5_ = g_strdup (_tmp4_);
	_g_free0 (self->priv->active_filename);
	self->priv->active_filename = _tmp5_;
	gtk_button_set_relief ((GtkButton*) self, GTK_RELIEF_NONE);
	gtk_button_set_focus_on_click ((GtkButton*) self, FALSE);
	_tmp6_ = inactive_filename;
	_tmp7_ = (GtkImage*) gtk_image_new_from_file (_tmp6_);
	g_object_ref_sink (_tmp7_);
	_g_object_unref0 (self->priv->i);
	self->priv->i = _tmp7_;
	_tmp8_ = self->priv->i;
	gtk_widget_set_visible ((GtkWidget*) _tmp8_, TRUE);
	_tmp9_ = self->priv->i;
	gtk_container_add ((GtkContainer*) self, (GtkWidget*) _tmp9_);
	_tmp10_ = label;
	_tmp11_ = _g_object_ref0 (_tmp10_);
	_g_object_unref0 (self->priv->l);
	self->priv->l = _tmp11_;
	_tmp12_ = self->priv->l;
	if (_tmp12_ != NULL) {
		GtkLabel* _tmp13_ = NULL;
		GtkLabel* _tmp14_ = NULL;
		PangoFontDescription* _tmp15_ = NULL;
		PangoFontDescription* _tmp16_ = NULL;
		GtkLabel* _tmp17_ = NULL;
		GdkRGBA _tmp18_ = {0};
		GtkLabel* _tmp19_ = NULL;
		GdkRGBA _tmp20_ = {0};
		GtkLabel* _tmp21_ = NULL;
		GdkRGBA _tmp22_ = {0};
		AtkObject* _tmp23_ = NULL;
		GtkLabel* _tmp24_ = NULL;
		const gchar* _tmp25_ = NULL;
		_tmp13_ = self->priv->l;
		gtk_widget_set_visible ((GtkWidget*) _tmp13_, TRUE);
		_tmp14_ = self->priv->l;
		_tmp15_ = pango_font_description_from_string ("Ubuntu Light 12");
		_tmp16_ = _tmp15_;
		gtk_widget_override_font ((GtkWidget*) _tmp14_, _tmp16_);
		__vala_PangoFontDescription_free0 (_tmp16_);
		_tmp17_ = self->priv->l;
		_tmp18_.red = (gdouble) 1.0f;
		_tmp18_.green = (gdouble) 1.0f;
		_tmp18_.blue = (gdouble) 1.0f;
		_tmp18_.alpha = (gdouble) 0.0f;
		gtk_widget_override_color ((GtkWidget*) _tmp17_, GTK_STATE_FLAG_NORMAL, &_tmp18_);
		_tmp19_ = self->priv->l;
		_tmp20_.red = (gdouble) 1.0f;
		_tmp20_.green = (gdouble) 1.0f;
		_tmp20_.blue = (gdouble) 1.0f;
		_tmp20_.alpha = (gdouble) 1.0f;
		gtk_widget_override_color ((GtkWidget*) _tmp19_, GTK_STATE_FLAG_FOCUSED, &_tmp20_);
		_tmp21_ = self->priv->l;
		_tmp22_.red = (gdouble) 1.0f;
		_tmp22_.green = (gdouble) 1.0f;
		_tmp22_.blue = (gdouble) 1.0f;
		_tmp22_.alpha = (gdouble) 1.0f;
		gtk_widget_override_color ((GtkWidget*) _tmp21_, GTK_STATE_FLAG_ACTIVE, &_tmp22_);
		_tmp23_ = gtk_widget_get_accessible ((GtkWidget*) self);
		_tmp24_ = self->priv->l;
		_tmp25_ = gtk_label_get_text (_tmp24_);
		atk_object_set_name (_tmp23_, _tmp25_);
	}
	unity_greeter_add_style_class ((GtkWidget*) self);
	{
		GtkCssProvider* style = NULL;
		GtkCssProvider* _tmp26_ = NULL;
		GtkStyleContext* _tmp27_ = NULL;
		_tmp26_ = gtk_css_provider_new ();
		style = _tmp26_;
		gtk_css_provider_load_from_data (style, "* {padding: 0px 0px 0px 0px; border: 0px; }", (gssize) (-1), &_inner_error_);
		if (_inner_error_ != NULL) {
			_g_object_unref0 (style);
			goto __catch26_g_error;
		}
		_tmp27_ = gtk_widget_get_style_context ((GtkWidget*) self);
		gtk_style_context_add_provider (_tmp27_, (GtkStyleProvider*) style, (guint) GTK_STYLE_PROVIDER_PRIORITY_APPLICATION);
		_g_object_unref0 (style);
	}
	goto __finally26;
	__catch26_g_error:
	{
		GError* e = NULL;
		GError* _tmp28_ = NULL;
		const gchar* _tmp29_ = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp28_ = e;
		_tmp29_ = _tmp28_->message;
		g_debug ("shutdown-dialog.vala:593: Internal error loading session chooser style" \
": %s", _tmp29_);
		_g_error_free0 (e);
	}
	__finally26:
	if (_inner_error_ != NULL) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
	return self;
}


DialogButton* dialog_button_new (const gchar* inactive_filename, const gchar* focused_filename, const gchar* active_filename, GtkLabel* label) {
	return dialog_button_construct (TYPE_DIALOG_BUTTON, inactive_filename, focused_filename, active_filename, label);
}


static gboolean dialog_button_real_enter_notify_event (GtkWidget* base, GdkEventCrossing* event) {
	DialogButton * self;
	gboolean result = FALSE;
	GdkEventCrossing _tmp0_ = {0};
	gboolean _tmp1_ = FALSE;
	self = (DialogButton*) base;
	g_return_val_if_fail (event != NULL, FALSE);
	gtk_widget_grab_focus ((GtkWidget*) self);
	_tmp0_ = *event;
	_tmp1_ = GTK_WIDGET_CLASS (dialog_button_parent_class)->enter_notify_event ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, GTK_TYPE_BUTTON, GtkButton), &_tmp0_);
	result = _tmp1_;
	return result;
}


static gboolean dialog_button_real_leave_notify_event (GtkWidget* base, GdkEventCrossing* event) {
	DialogButton * self;
	gboolean result = FALSE;
	GtkWidget* _tmp0_ = NULL;
	GdkEventCrossing _tmp1_ = {0};
	gboolean _tmp2_ = FALSE;
	self = (DialogButton*) base;
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = gtk_widget_get_toplevel ((GtkWidget*) self);
	gtk_window_set_focus (G_TYPE_CHECK_INSTANCE_TYPE (_tmp0_, GTK_TYPE_WINDOW) ? ((GtkWindow*) _tmp0_) : NULL, NULL);
	_tmp1_ = *event;
	_tmp2_ = GTK_WIDGET_CLASS (dialog_button_parent_class)->leave_notify_event ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, GTK_TYPE_BUTTON, GtkButton), &_tmp1_);
	result = _tmp2_;
	return result;
}


static gboolean dialog_button_real_draw (GtkWidget* base, cairo_t* c) {
	DialogButton * self;
	gboolean result = FALSE;
	GtkImage* _tmp0_ = NULL;
	cairo_t* _tmp1_ = NULL;
	self = (DialogButton*) base;
	g_return_val_if_fail (c != NULL, FALSE);
	_tmp0_ = self->priv->i;
	_tmp1_ = c;
	gtk_widget_draw ((GtkWidget*) _tmp0_, _tmp1_);
	result = TRUE;
	return result;
}


static void dialog_button_real_state_flags_changed (GtkWidget* base, GtkStateFlags previous_state) {
	DialogButton * self;
	GtkStateFlags new_flags = 0;
	GtkStateFlags _tmp0_ = 0;
	gboolean _tmp1_ = FALSE;
	gboolean _tmp2_ = FALSE;
	GtkStateFlags _tmp3_ = 0;
	gboolean _tmp6_ = FALSE;
	gboolean _tmp8_ = FALSE;
	GtkLabel* _tmp19_ = NULL;
	GtkStateFlags _tmp22_ = 0;
	self = (DialogButton*) base;
	_tmp0_ = gtk_widget_get_state_flags ((GtkWidget*) self);
	new_flags = _tmp0_;
	_tmp3_ = new_flags;
	if ((_tmp3_ & GTK_STATE_FLAG_PRELIGHT) != 0) {
		gboolean _tmp4_ = FALSE;
		gboolean _tmp5_ = FALSE;
		g_object_get ((GtkWidget*) self, "can-focus", &_tmp4_, NULL);
		_tmp5_ = _tmp4_;
		_tmp2_ = !_tmp5_;
	} else {
		_tmp2_ = FALSE;
	}
	_tmp6_ = _tmp2_;
	if (_tmp6_) {
		_tmp1_ = TRUE;
	} else {
		GtkStateFlags _tmp7_ = 0;
		_tmp7_ = new_flags;
		_tmp1_ = (_tmp7_ & GTK_STATE_FLAG_FOCUSED) != 0;
	}
	_tmp8_ = _tmp1_;
	if (_tmp8_) {
		gboolean _tmp9_ = FALSE;
		GtkStateFlags _tmp10_ = 0;
		gboolean _tmp12_ = FALSE;
		_tmp10_ = new_flags;
		if ((_tmp10_ & GTK_STATE_FLAG_ACTIVE) != 0) {
			const gchar* _tmp11_ = NULL;
			_tmp11_ = self->priv->active_filename;
			_tmp9_ = _tmp11_ != NULL;
		} else {
			_tmp9_ = FALSE;
		}
		_tmp12_ = _tmp9_;
		if (_tmp12_) {
			GtkImage* _tmp13_ = NULL;
			const gchar* _tmp14_ = NULL;
			_tmp13_ = self->priv->i;
			_tmp14_ = self->priv->active_filename;
			gtk_image_set_from_file (_tmp13_, _tmp14_);
		} else {
			GtkImage* _tmp15_ = NULL;
			const gchar* _tmp16_ = NULL;
			_tmp15_ = self->priv->i;
			_tmp16_ = self->priv->focused_filename;
			gtk_image_set_from_file (_tmp15_, _tmp16_);
		}
	} else {
		GtkImage* _tmp17_ = NULL;
		const gchar* _tmp18_ = NULL;
		_tmp17_ = self->priv->i;
		_tmp18_ = self->priv->inactive_filename;
		gtk_image_set_from_file (_tmp17_, _tmp18_);
	}
	_tmp19_ = self->priv->l;
	if (_tmp19_ != NULL) {
		GtkLabel* _tmp20_ = NULL;
		GtkStateFlags _tmp21_ = 0;
		_tmp20_ = self->priv->l;
		_tmp21_ = new_flags;
		gtk_widget_set_state_flags ((GtkWidget*) _tmp20_, _tmp21_, TRUE);
	}
	_tmp22_ = previous_state;
	GTK_WIDGET_CLASS (dialog_button_parent_class)->state_flags_changed ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, GTK_TYPE_BUTTON, GtkButton), _tmp22_);
}


static void dialog_button_class_init (DialogButtonClass * klass) {
	dialog_button_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (DialogButtonPrivate));
	GTK_WIDGET_CLASS (klass)->enter_notify_event = dialog_button_real_enter_notify_event;
	GTK_WIDGET_CLASS (klass)->leave_notify_event = dialog_button_real_leave_notify_event;
	GTK_WIDGET_CLASS (klass)->draw = dialog_button_real_draw;
	GTK_WIDGET_CLASS (klass)->state_flags_changed = dialog_button_real_state_flags_changed;
	G_OBJECT_CLASS (klass)->finalize = dialog_button_finalize;
}


static void dialog_button_instance_init (DialogButton * self) {
	self->priv = DIALOG_BUTTON_GET_PRIVATE (self);
}


static void dialog_button_finalize (GObject* obj) {
	DialogButton * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, TYPE_DIALOG_BUTTON, DialogButton);
	_g_free0 (self->priv->inactive_filename);
	_g_free0 (self->priv->focused_filename);
	_g_free0 (self->priv->active_filename);
	_g_object_unref0 (self->priv->i);
	_g_object_unref0 (self->priv->l);
	G_OBJECT_CLASS (dialog_button_parent_class)->finalize (obj);
}


GType dialog_button_get_type (void) {
	static volatile gsize dialog_button_type_id__volatile = 0;
	if (g_once_init_enter (&dialog_button_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (DialogButtonClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) dialog_button_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (DialogButton), 0, (GInstanceInitFunc) dialog_button_instance_init, NULL };
		GType dialog_button_type_id;
		dialog_button_type_id = g_type_register_static (GTK_TYPE_BUTTON, "DialogButton", &g_define_type_info, 0);
		g_once_init_leave (&dialog_button_type_id__volatile, dialog_button_type_id);
	}
	return dialog_button_type_id__volatile;
}



